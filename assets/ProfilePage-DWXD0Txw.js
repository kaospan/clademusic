import{c as Y,a as K,k as B,l as p,n as ae,o as re,j as e,p as ss,q as R,t as ts,r as v,S as as,B as A,g as Q,u as rs,i as ns,v as ls,w as is,x as os,y as cs,z as ds,b as ms,A as us,D as xs,E as hs,d as ps,F as fs,L as gs,m as C,M as V,G as Te,X as ys,P as js,Q as Le,f as z}from"./index-dsV8UFV2.js";import{C as vs}from"./ChordBadge-C7PzrVvS.js";import{P as Me}from"./PageLayout-C6g9oPx-.js";import{E as Ns,f as F}from"./animations-BFfsopzC.js";import{R as bs,a as de}from"./ResponsiveLayout-Mb6uUF7z.js";import{I as he}from"./input-C2T6aPV6.js";import{n as ws}from"./navigation-PB9wrqL7.js";import{a as _s,u as Cs,b as ks,c as Ss}from"./useLastFm-68ie8o9Q.js";import{D as Ue,a as Oe,b as He,c as Ke,d as Ps,e as Fs}from"./dialog-BxjGng9K.js";import{T as Ve,a as Qe,b as $,c as M}from"./tabs-kASm9EVP.js";import{A as As,a as Ds,b as Ts}from"./avatar-CJhveEdW.js";import{L as H}from"./label-CLqXzCl4.js";import{S as X,a as J,b as ee,c as se,d as te}from"./select-BfJw0Dwm.js";import{T as Ls}from"./textarea-BSKwG_jN.js";import{S as Ms}from"./switch-BSjZzMkT.js";import{U as me}from"./BottomNav-BTXP58Ko.js";import{S as qe}from"./shield-D2u2DtGf.js";import{Z as qs}from"./zap-BXXNDMLI.js";import{C as Es}from"./chart-column-5YX2ZLXI.js";import{S as Ee}from"./sparkles-0AVN6Sjs.js";import{L as zs}from"./link-Ck2YW5CZ.js";import{C as ue}from"./check-iqeSYT-9.js";import{C as ze}from"./chevron-right-CKZK2Een.js";import{R as Re}from"./radio-Cp4GVx6F.js";import{T as Rs}from"./trending-up-mAu2gWkH.js";import{D as $s}from"./disc-3-WkXU6alq.js";import{C as $e}from"./clock-DMCKdZoN.js";import{H as Bs}from"./heart-Be8bveni.js";import{B as Is}from"./bookmark-Bz0Oin3v.js";import{f as Be}from"./formatDistanceToNow-3UBXKcFR.js";import"./CladeIcon-DzCA2ssi.js";import"./index-Bkwwyljo.js";import"./index-KuDaiwzR.js";import"./menu-ByOeQzcy.js";import"./search-BgbMEmkh.js";import"./en-US-wfBU2YNu.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Us=Y("Code",[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Os=Y("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pe=Y("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hs=Y("PanelsTopLeft",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M9 21V9",key:"1oto5p"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ks=Y("Type",[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vs=Y("WandSparkles",[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]]);function Qs(t={}){const{user:l}=K(),{limit:a=20}=t;return B({queryKey:["play-history",l==null?void 0:l.id,a],queryFn:async()=>{if(!l)return[];const{data:i,error:o}=await p.from("user_interactions").select(`
          id,
          user_id,
          track_id,
          interaction_type,
          created_at
        `).eq("user_id",l.id).like("interaction_type","play_%").order("created_at",{ascending:!1}).limit(a);return o?(console.warn("Failed to fetch play history:",o),[]):(i||[]).map(c=>({id:c.id,user_id:c.user_id,track_id:c.track_id,provider:"spotify",action:c.interaction_type.replace("play_",""),played_at:c.created_at}))},enabled:!!l})}function Ys(){const{user:t}=K();return B({queryKey:["play-stats",t==null?void 0:t.id],queryFn:async()=>{if(!t)return null;const{count:l}=await p.from("user_interactions").select("*",{count:"exact",head:!0}).eq("user_id",t.id).like("interaction_type","play_%");return{totalPlays:l||0,providerCounts:{},recentPlays:0}},enabled:!!t})}function Gs(){const{user:t}=K();return B({queryKey:["profile",t==null?void 0:t.id],queryFn:async()=>{if(!t)return null;const{data:l,error:a}=await p.from("profiles").select("*").eq("id",t.id).single();if(a)throw a;return l},enabled:!!t})}function Ws(){const{user:t}=K();return B({queryKey:["user-providers",t==null?void 0:t.id],queryFn:async()=>{if(!t)return[];const{data:l,error:a}=await p.from("user_providers").select("*").eq("user_id",t.id).order("connected_at",{ascending:!1});if(a)throw a;return l},enabled:!!t})}function Zs(){const{user:t}=K(),l=ae();return re({mutationFn:async a=>{if(!t)throw new Error("Not authenticated");const{data:i,error:o}=await p.from("profiles").update({preferred_provider:a}).eq("id",t.id).select().single();if(o)throw o;return i},onSuccess:()=>{l.invalidateQueries({queryKey:["profile"]})}})}function Xs(t){return B({queryKey:["user-interaction-stats",t],queryFn:async()=>{if(!t)return{likes:0,saves:0,shares:0};const[l,a,i]=await Promise.all([p.from("user_interactions").select("*",{count:"exact",head:!0}).eq("user_id",t).eq("interaction_type","like"),p.from("user_interactions").select("*",{count:"exact",head:!0}).eq("user_id",t).eq("interaction_type","save"),p.from("user_interactions").select("*",{count:"exact",head:!0}).eq("user_id",t).eq("interaction_type","share")]);return{likes:l.count||0,saves:a.count||0,shares:i.count||0}},enabled:!!t})}async function Js(t){var l;try{const[a,i]=await Promise.all([p.from("play_history").select("track_id, tracks!inner(*)").eq("user_id",t).order("played_at",{ascending:!1}).limit(200),p.from("user_interactions").select("track_id, tracks!inner(*)").eq("user_id",t).in("interaction_type",["like","save"]).order("created_at",{ascending:!1}).limit(100)]),o=(a.data||[]).map(n=>n.tracks).filter(Boolean),c=(i.data||[]).map(n=>n.tracks).filter(Boolean),f=new Map;[...o,...c].forEach(n=>{n!=null&&n.id&&f.set(n.id,n)});const u=Array.from(f.values());if(u.length===0)return null;const k=new Map;u.forEach(n=>{if(n.progression_roman&&n.progression_roman.length>0){const m=n.progression_roman.join("â†’"),S=k.get(m);S?(S.count++,S.tracks.push(n.id)):k.set(m,{count:1,tracks:[n.id]})}});const I=Array.from(k.entries()).map(([n,m])=>({progression:n.split("â†’"),count:m.count,tracks:m.tracks})).sort((n,m)=>m.count-n.count).slice(0,5),_=u.reduce((n,m)=>(m.detected_mode==="major"?n.major++:m.detected_mode==="minor"&&n.minor++,n),{major:0,minor:0}),D=_.major+_.minor,T=D>0?[{mode:"major",percentage:Math.round(_.major/D*100),count:_.major},{mode:"minor",percentage:Math.round(_.minor/D*100),count:_.minor}].sort((n,m)=>m.percentage-n.percentage):[],q=u.filter(n=>typeof n.energy=="number").map(n=>n.energy),U=q.length>0?q.reduce((n,m)=>n+m,0)/q.length:.5,O=u.reduce((n,m)=>{const S=m.cadence_type||"loop";return n[S]=(n[S]||0)+1,n},{}),x=((l=Object.entries(O).sort((n,m)=>m[1]-n[1])[0])==null?void 0:l[0])||"loop",b=u.filter(n=>typeof n.tempo=="number").map(n=>n.tempo),L=b.length>0?Math.round(b.reduce((n,m)=>n+m,0)/b.length):120;return{favoriteProgressions:I,preferredModes:T,energyPreference:U,cadencePreference:x,averageTempo:L,totalTracksAnalyzed:u.length}}catch(a){return console.error("Error computing taste DNA:",a),null}}function et(){const{user:t}=K();return B({queryKey:["taste-dna",t==null?void 0:t.id],queryFn:async()=>t!=null&&t.id?Js(t.id):null,enabled:!!(t!=null&&t.id),staleTime:5*60*1e3,gcTime:10*60*1e3})}function xe(t){const l=new Date,a=typeof t=="string"?new Date(t):t,i=l.getTime()-a.getTime(),o=Math.floor(i/6e4),c=Math.floor(i/36e5),f=Math.floor(i/864e5);return o<1?"just now":o<60?`${o}m ago`:c<24?`${c}h ago`:f<7?`${f}d ago`:a.toLocaleDateString()}function st({provider:t,className:l,showIcon:a=!0,showName:i=!0,size:o="md"}){const c=R[t],f={sm:"px-1.5 py-0.5 text-[10px] gap-0.5",md:"px-2 py-0.5 text-xs gap-1",lg:"px-3 py-1 text-sm gap-1.5"};return e.jsxs("span",{className:ss("inline-flex items-center rounded font-medium",f[o],l),style:{backgroundColor:`${c.color}20`,color:c.color},children:[a&&e.jsx("span",{className:o==="sm"?"text-[8px]":o==="md"?"text-[10px]":"text-xs",children:c.icon}),i&&e.jsx("span",{children:c.name})]})}function tt(t){return B({queryKey:["userTheme",t],queryFn:async()=>{var o;const l=t||((o=(await p.auth.getUser()).data.user)==null?void 0:o.id);if(!l)throw new Error("No user ID provided");const{data:a,error:i}=await p.from("user_themes").select("*").eq("user_id",l).maybeSingle();if(i)throw i;return a},staleTime:5*60*1e3,enabled:!!t||!0})}function at(){return B({queryKey:["themePresets"],queryFn:async()=>{const{data:t,error:l}=await p.from("theme_presets").select("*").order("is_featured",{ascending:!1}).order("usage_count",{ascending:!1});if(l)throw l;return t},staleTime:10*60*1e3})}function rt(){const t=ae();return re({mutationFn:async l=>{const{data:a,error:i}=await p.from("user_themes").insert(l).select().single();if(i)throw i;return a},onSuccess:l=>{t.invalidateQueries({queryKey:["userTheme",l.user_id]})}})}function nt(){const t=ae();return re({mutationFn:async({userId:l,updates:a})=>{const{data:i,error:o}=await p.from("user_themes").update(a).eq("user_id",l).select().single();if(o)throw o;return i},onSuccess:l=>{t.invalidateQueries({queryKey:["userTheme",l.user_id]})}})}function lt(){const t=ae();return re({mutationFn:async({userId:l,presetId:a})=>{const{data:i,error:o}=await p.from("theme_presets").select("*").eq("id",a).single();if(o)throw o;await p.rpc("increment_theme_usage",{preset_id:a});const{data:c}=await p.from("user_themes").select("id").eq("user_id",l).maybeSingle();if(c){const{data:f,error:u}=await p.from("user_themes").update({theme_name:i.name,colors:i.colors,fonts:i.fonts,layout:i.layout,custom_css:i.custom_css,player_skin:i.player_skin,animated_background:i.animated_background}).eq("user_id",l).select().single();if(u)throw u;return f}else{const{data:f,error:u}=await p.from("user_themes").insert({user_id:l,theme_name:i.name,colors:i.colors,fonts:i.fonts,layout:i.layout,custom_css:i.custom_css,player_skin:i.player_skin,animated_background:i.animated_background}).select().single();if(u)throw u;return f}},onSuccess:l=>{t.invalidateQueries({queryKey:["userTheme",l.user_id]}),t.invalidateQueries({queryKey:["themePresets"]})}})}const it={background:"#000000",surface:"#1a1a1a",primary:"#3b82f6",secondary:"#8b5cf6",accent:"#f59e0b",text:"#ffffff",textMuted:"#9ca3af"},ot={heading:"Inter",body:"Inter"},Ie=["Inter","Roboto","Open Sans","Lato","Montserrat","Poppins","Playfair Display","Lora","Merriweather","Roboto Mono","Fira Code","Source Code Pro","Orbitron","Press Start 2P","Audiowide"],ct=[{value:"modern",label:"Modern"},{value:"minimal",label:"Minimal"},{value:"retro",label:"Retro"},{value:"neon",label:"Neon"},{value:"academic",label:"Academic"}],dt=[{value:"default",label:"Default"},{value:"compact",label:"Compact"},{value:"glassmorphism",label:"Glassmorphism"},{value:"retro",label:"Retro"},{value:"minimal",label:"Minimal"}];function mt({open:t,onOpenChange:l,currentTheme:a,userId:i}){const{toast:o}=ts(),[c,f]=v.useState((a==null?void 0:a.colors)||it),[u,k]=v.useState((a==null?void 0:a.fonts)||ot),[I,_]=v.useState((a==null?void 0:a.layout)||"modern"),[D,T]=v.useState((a==null?void 0:a.custom_css)||""),[q,U]=v.useState((a==null?void 0:a.player_skin)||"default"),[O,x]=v.useState((a==null?void 0:a.animated_background)||!1),{data:b}=at(),L=nt(),n=rt(),m=lt();v.useEffect(()=>{a&&(f(a.colors),k(a.fonts),_(a.layout),T(a.custom_css||""),U(a.player_skin),x(a.animated_background))},[a]);const S=async()=>{try{const r={colors:c,fonts:u,layout:I,custom_css:D||null,player_skin:q,animated_background:O};a?await L.mutateAsync({userId:i,updates:r}):await n.mutateAsync({user_id:i,...r}),o({title:"Theme saved",description:"Your profile theme has been updated successfully."}),l(!1)}catch(r){o({title:"Error saving theme",description:r instanceof Error?r.message:"Failed to save theme",variant:"destructive"})}},ne=async r=>{try{const h=await m.mutateAsync({userId:i,presetId:r});f(h.colors),k(h.fonts),_(h.layout),T(h.custom_css||""),U(h.player_skin||"default"),x(h.animated_background),o({title:"Preset applied",description:"Theme preset has been applied to the editor."})}catch(h){o({title:"Error applying preset",description:h instanceof Error?h.message:"Failed to apply preset",variant:"destructive"})}},G=(r,h)=>{f(y=>({...y,[r]:h}))},g=(r,h)=>{k(y=>({...y,[r]:h}))};return e.jsx(Ue,{open:t,onOpenChange:l,children:e.jsxs(Oe,{className:"max-w-5xl h-[90vh]",children:[e.jsx(He,{children:e.jsxs(Ke,{className:"flex items-center gap-2",children:[e.jsx(pe,{className:"w-5 h-5"}),"Theme Editor"]})}),e.jsxs("div",{className:"flex gap-4 flex-1 overflow-hidden",children:[e.jsx("div",{className:"flex-1 overflow-y-auto",children:e.jsxs(Ve,{defaultValue:"presets",className:"w-full",children:[e.jsxs(Qe,{className:"grid w-full grid-cols-5",children:[e.jsxs($,{value:"presets",className:"flex items-center gap-1",children:[e.jsx(Vs,{className:"w-3 h-3"}),e.jsx("span",{className:"hidden sm:inline",children:"Presets"})]}),e.jsxs($,{value:"colors",className:"flex items-center gap-1",children:[e.jsx(pe,{className:"w-3 h-3"}),e.jsx("span",{className:"hidden sm:inline",children:"Colors"})]}),e.jsxs($,{value:"fonts",className:"flex items-center gap-1",children:[e.jsx(Ks,{className:"w-3 h-3"}),e.jsx("span",{className:"hidden sm:inline",children:"Fonts"})]}),e.jsxs($,{value:"layout",className:"flex items-center gap-1",children:[e.jsx(Hs,{className:"w-3 h-3"}),e.jsx("span",{className:"hidden sm:inline",children:"Layout"})]}),e.jsxs($,{value:"advanced",className:"flex items-center gap-1",children:[e.jsx(Us,{className:"w-3 h-3"}),e.jsx("span",{className:"hidden sm:inline",children:"Advanced"})]})]}),e.jsxs(as,{className:"h-[calc(90vh-180px)] mt-4",children:[e.jsxs(M,{value:"presets",className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Start with a pre-made theme and customize it to your liking."}),e.jsx("div",{className:"grid grid-cols-1 gap-3",children:b==null?void 0:b.map(r=>e.jsxs("button",{onClick:()=>ne(r.id),className:"flex items-start gap-3 p-4 rounded-lg border hover:bg-accent transition-colors text-left",children:[e.jsx("div",{className:"w-12 h-12 rounded border shrink-0",style:{background:`linear-gradient(135deg, ${r.colors.primary}, ${r.colors.secondary})`}}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-medium",children:r.name}),e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-1",children:r.description}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[r.is_featured&&e.jsx("span",{className:"text-xs bg-primary/10 text-primary px-2 py-0.5 rounded",children:"Featured"}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[r.usage_count," uses"]})]})]})]},r.id))})]}),e.jsx(M,{value:"colors",className:"space-y-4",children:Object.entries(c).map(([r,h])=>e.jsxs("div",{className:"space-y-2",children:[e.jsx(H,{htmlFor:r,className:"capitalize",children:r.replace(/([A-Z])/g," $1").trim()}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(he,{id:r,type:"color",value:h,onChange:y=>G(r,y.target.value),className:"w-20 h-10 p-1 cursor-pointer"}),e.jsx(he,{type:"text",value:h,onChange:y=>G(r,y.target.value),className:"flex-1",placeholder:"#000000"})]})]},r))}),e.jsxs(M,{value:"fonts",className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(H,{htmlFor:"heading-font",children:"Heading Font"}),e.jsxs(X,{value:u.heading,onValueChange:r=>g("heading",r),children:[e.jsx(J,{id:"heading-font",children:e.jsx(ee,{})}),e.jsx(se,{children:Ie.map(r=>e.jsx(te,{value:r,style:{fontFamily:r},children:r},r))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(H,{htmlFor:"body-font",children:"Body Font"}),e.jsxs(X,{value:u.body,onValueChange:r=>g("body",r),children:[e.jsx(J,{id:"body-font",children:e.jsx(ee,{})}),e.jsx(se,{children:Ie.map(r=>e.jsx(te,{value:r,style:{fontFamily:r},children:r},r))})]})]})]}),e.jsxs(M,{value:"layout",className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(H,{htmlFor:"layout-select",children:"Layout Style"}),e.jsxs(X,{value:I,onValueChange:_,children:[e.jsx(J,{id:"layout-select",children:e.jsx(ee,{})}),e.jsx(se,{children:ct.map(r=>e.jsx(te,{value:r.value,children:r.label},r.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(H,{htmlFor:"player-skin",children:"Player Skin"}),e.jsxs(X,{value:q,onValueChange:U,children:[e.jsx(J,{id:"player-skin",children:e.jsx(ee,{})}),e.jsx(se,{children:dt.map(r=>e.jsx(te,{value:r.value,children:r.label},r.value))})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(H,{htmlFor:"animated-bg",children:"Animated Background"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Enable subtle background animation"})]}),e.jsx(Ms,{id:"animated-bg",checked:O,onCheckedChange:x})]})]}),e.jsx(M,{value:"advanced",className:"space-y-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(H,{htmlFor:"custom-css",children:"Custom CSS"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Advanced: Add custom CSS to further customize your profile"}),e.jsx(Ls,{id:"custom-css",value:D,onChange:r=>T(r.target.value),placeholder:".profile-header { ... }",className:"font-mono text-sm min-h-[200px]"})]})})]})]})}),e.jsxs("div",{className:"w-80 rounded-lg border p-4 overflow-hidden",style:{backgroundColor:c.background,color:c.text,fontFamily:u.body},children:[e.jsx("h3",{className:"text-sm font-medium mb-3",style:{fontFamily:u.heading},children:"Live Preview"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"p-3 rounded",style:{backgroundColor:c.surface},children:[e.jsx("h4",{className:"font-semibold mb-1",style:{fontFamily:u.heading,color:c.primary},children:"Heading Text"}),e.jsx("p",{className:"text-sm",style:{color:c.textMuted},children:"This is how your body text will appear on your profile."})]}),e.jsx("button",{className:"w-full py-2 px-4 rounded font-medium",style:{backgroundColor:c.primary,color:c.background},children:"Primary Button"}),e.jsx("button",{className:"w-full py-2 px-4 rounded font-medium",style:{backgroundColor:c.secondary,color:c.background},children:"Secondary Button"}),e.jsx("div",{className:"p-2 rounded text-sm",style:{backgroundColor:c.accent,color:c.background},children:"Accent Color"})]})]})]}),e.jsxs(Ps,{children:[e.jsx(A,{variant:"outline",onClick:()=>l(!1),children:"Cancel"}),e.jsxs(A,{onClick:S,disabled:L.isPending||n.isPending,children:[(L.isPending||n.isPending)&&e.jsx(Q,{className:"w-4 h-4 mr-2 animate-spin"}),"Save Theme"]})]})]})})}const ut={energetic:"from-orange-500 to-red-500",chill:"from-blue-400 to-cyan-400",melancholic:"from-purple-500 to-indigo-600",upbeat:"from-yellow-400 to-orange-400",balanced:"from-green-400 to-emerald-500"},xt={energetic:"âš¡",chill:"ðŸŒŠ",melancholic:"ðŸŒ™",upbeat:"â˜€ï¸",balanced:"ðŸŽ¯"};function Wt(){var ke,Se,Pe,Fe,Ae;const{user:t,signOut:l,loading:a}=K(),i=rs(),[o,c]=v.useState("all"),[f,u]=v.useState(!1),[k,I]=v.useState(""),[_,D]=v.useState(!1),[T,q]=v.useState("medium_term"),[U,O]=v.useState(!1),{data:x}=Gs(),{data:b=[],refetch:L}=Ws(),{data:n}=Ys(),{data:m}=Xs(t==null?void 0:t.id),{data:S=[]}=Qs({limit:20,provider:o==="all"?void 0:o}),ne=Zs(),{data:G}=ns(),{data:g}=ls(),{data:r=[]}=is(T,10),{data:h=[]}=os(T,10),{data:y}=cs(20),{data:w}=ds(),{data:fe=[]}=ms([],[],10),ge=us(),ye=xs(),{data:je}=_s(),{data:P}=Cs(),W=ks(),le=Ss(),{data:j,isLoading:ie}=et(),{data:Ye}=tt(t==null?void 0:t.id),{data:ve}=hs(),{openPlayer:Ne}=ps(),oe=G===!0,be=r.length>0?"tracks":h.length>0?"artists":"recent",Z=!!je,Ge=(m==null?void 0:m.likes)??0,We=(m==null?void 0:m.saves)??0,Ze=async()=>{await l(),i("/")},Xe=async()=>{try{await ge.mutateAsync()}catch(s){z.error(s.message||"Failed to connect Spotify")}},Je=async()=>{try{await ye.mutateAsync(),z.success("Spotify disconnected"),L()}catch{z.error("Failed to disconnect Spotify")}},we=async()=>{if(!k.trim()){z.error("Please enter your Last.fm username");return}try{await W.mutateAsync(k.trim()),z.success("Last.fm connected successfully!"),D(!1),I(""),L()}catch(s){z.error(s.message||"Failed to connect Last.fm")}},es=async()=>{try{await le.mutateAsync(),z.success("Last.fm disconnected"),L()}catch{z.error("Failed to disconnect Last.fm")}},_e=async s=>{try{await ne.mutateAsync(s),u(!1)}catch(d){console.error("Failed to set preferred provider:",d)}},Ce=v.useCallback(s=>s.spotifyId||s.spotify_id?"spotify":s.youtubeId||s.youtube_id?"youtube":fs()??null,[]),ce=v.useCallback(s=>{const d=Ce(s);if(!d)return;const N=d==="spotify"?s.spotifyId||s.spotify_id:s.youtubeId||s.youtube_id;N&&Ne({canonicalTrackId:s.id||s.track_id||null,provider:d,providerTrackId:N,title:s.title,artist:s.artist,album:s.album,autoplay:!0,context:"profile-recent"})},[Ne,Ce]);return a?e.jsx(gs,{fullScreen:!0}):t?e.jsxs(Me,{title:"Profile",headerActions:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(A,{variant:"ghost",size:"sm",onClick:()=>O(!0),children:[e.jsx(pe,{className:"w-4 h-4"}),"Theme"]}),ve&&e.jsxs(A,{variant:"ghost",size:"sm",onClick:()=>i("/admin"),children:[e.jsx(qe,{className:"w-4 h-4"}),"Admin"]}),e.jsx(A,{variant:"ghost",size:"icon",onClick:Ze,children:e.jsx(Os,{className:"w-5 h-5"})})]}),children:[e.jsxs(bs,{maxWidth:"full",className:"space-y-6",children:[e.jsxs(C.div,{variants:F,initial:"initial",animate:"animate",className:"flex items-center gap-4 p-4 glass rounded-2xl",children:[e.jsxs(As,{className:"w-16 h-16",children:[e.jsx(Ds,{src:(g==null?void 0:g.imageUrl)||(x==null?void 0:x.avatar_url)||void 0}),e.jsx(Ts,{className:"bg-gradient-to-br from-primary to-accent text-white text-xl",children:((ke=g==null?void 0:g.displayName)==null?void 0:ke[0])||((Se=t.email)==null?void 0:Se[0].toUpperCase())||"U"})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h2",{className:"font-bold truncate",children:(g==null?void 0:g.displayName)||((Pe=t.email)==null?void 0:Pe.split("@")[0])}),e.jsx("p",{className:"text-sm text-muted-foreground truncate",children:t.email}),g&&e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${g.product==="premium"?"bg-[#1DB954]/20 text-[#1DB954]":"bg-muted text-muted-foreground"}`,children:g.product==="premium"?"ðŸ‘‘ Premium":"Free"}),g.followers&&g.followers>0&&e.jsxs("span",{className:"text-xs text-muted-foreground",children:[g.followers," followers"]})]})]})]}),e.jsxs(C.div,{variants:F,initial:"initial",animate:"animate",transition:{delay:.05},className:"p-4 glass rounded-2xl",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(qs,{className:"w-5 h-5 text-primary"}),e.jsx("span",{className:"font-medium",children:"Credits"})]}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Free tier"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex-1 h-2 bg-muted rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full w-1/4 bg-gradient-to-r from-primary to-accent rounded-full"})}),e.jsx("span",{className:"text-sm font-medium",children:"25/100"})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Credits reset monthly. Used for track analysis."})]}),oe&&w&&e.jsxs(C.div,{variants:F,initial:"initial",animate:"animate",transition:{delay:.1},className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Es,{className:"w-5 h-5"}),e.jsx("h3",{className:"font-bold",children:"Your Music DNA"})]}),e.jsxs("div",{className:`p-6 rounded-2xl bg-gradient-to-br ${ut[w.moodProfile]} text-white`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("span",{className:"text-4xl",children:xt[w.moodProfile]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xl font-bold capitalize",children:w.moodProfile}),e.jsx("p",{className:"text-white/80 text-sm",children:"Your listening mood profile"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white/60 text-xs",children:"Energy"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex-1 h-2 bg-white/20 rounded-full",children:e.jsx("div",{className:"h-full bg-white rounded-full",style:{width:`${w.averageEnergy*100}%`}})}),e.jsxs("span",{className:"text-sm",children:[Math.round(w.averageEnergy*100),"%"]})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white/60 text-xs",children:"Danceability"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex-1 h-2 bg-white/20 rounded-full",children:e.jsx("div",{className:"h-full bg-white rounded-full",style:{width:`${w.averageDanceability*100}%`}})}),e.jsxs("span",{className:"text-sm",children:[Math.round(w.averageDanceability*100),"%"]})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white/60 text-xs",children:"Happiness"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex-1 h-2 bg-white/20 rounded-full",children:e.jsx("div",{className:"h-full bg-white rounded-full",style:{width:`${w.averageValence*100}%`}})}),e.jsxs("span",{className:"text-sm",children:[Math.round(w.averageValence*100),"%"]})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white/60 text-xs",children:"Avg Tempo"}),e.jsxs("p",{className:"text-lg font-bold",children:[Math.round(w.averageTempo)," BPM"]})]})]})]}),w.topGenres.length>0&&e.jsxs("div",{className:"p-4 glass rounded-2xl",children:[e.jsx("h4",{className:"text-sm font-medium text-muted-foreground mb-3",children:"Top Genres"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:w.topGenres.slice(0,8).map((s,d)=>e.jsx("span",{className:"px-3 py-1 rounded-full bg-primary/10 text-primary text-sm",style:{opacity:1-d*.08},children:s.genre},s.genre))})]})]}),e.jsxs(C.div,{variants:F,initial:"initial",animate:"animate",transition:{delay:.12},className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ee,{className:"w-5 h-5 text-accent"}),e.jsx("h3",{className:"font-bold",children:"Chord Taste DNA"}),(j==null?void 0:j.totalTracksAnalyzed)&&e.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",j.totalTracksAnalyzed," tracks analyzed)"]})]}),ie&&e.jsxs("div",{className:"p-8 glass rounded-2xl text-center",children:[e.jsx(Q,{className:"w-6 h-6 animate-spin mx-auto mb-2 text-muted-foreground"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Analyzing your musical taste..."})]}),!ie&&!j&&e.jsxs("div",{className:"p-8 glass rounded-2xl text-center",children:[e.jsx(V,{className:"w-8 h-8 mx-auto mb-2 text-muted-foreground"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Start listening to tracks to build your taste profile"})]}),!ie&&j&&e.jsxs(e.Fragment,{children:[j.favoriteProgressions.length>0?e.jsxs("div",{className:"p-4 glass rounded-2xl space-y-3",children:[e.jsx("h4",{className:"text-sm font-medium text-muted-foreground",children:"Favorite Progressions"}),j.favoriteProgressions.map((s,d)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex gap-1",children:s.progression.map((N,E)=>e.jsx(vs,{chord:N,size:"sm"},E))}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[s.count," ",s.count===1?"song":"songs"]})]},d))]}):e.jsx("div",{className:"p-4 glass rounded-2xl text-center text-sm text-muted-foreground",children:"No chord progressions detected yet"}),j.preferredModes.length>0&&e.jsxs("div",{className:"p-4 glass rounded-2xl space-y-3",children:[e.jsx("h4",{className:"text-sm font-medium text-muted-foreground",children:"Mode Preference"}),e.jsx("div",{className:"flex gap-2",children:j.preferredModes.map(s=>e.jsxs("div",{className:"flex-1 p-3 rounded-xl bg-muted/50 text-center",children:[e.jsxs("span",{className:"text-lg font-bold",children:[s.percentage,"%"]}),e.jsx("p",{className:"text-xs text-muted-foreground capitalize",children:s.mode}),e.jsxs("p",{className:"text-xs text-muted-foreground/60",children:[s.count," tracks"]})]},s.mode))})]}),e.jsxs("div",{className:"p-4 glass rounded-2xl space-y-3",children:[e.jsx("h4",{className:"text-sm font-medium text-muted-foreground",children:"Energy Preference"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:"Low"}),e.jsx("div",{className:"flex-1 h-2 bg-muted rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-primary to-accent rounded-full transition-all",style:{width:`${j.energyPreference*100}%`}})}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"High"})]}),e.jsxs("p",{className:"text-xs text-muted-foreground text-center",children:[Math.round(j.energyPreference*100),"% energy â€¢ ",j.averageTempo," BPM avg"]})]}),j.cadencePreference&&e.jsxs("div",{className:"p-4 glass rounded-2xl",children:[e.jsx("h4",{className:"text-sm font-medium text-muted-foreground mb-2",children:"Cadence Style"}),e.jsx("span",{className:"inline-block px-3 py-1 rounded-full bg-primary/10 text-primary text-sm capitalize",children:j.cadencePreference})]})]})]}),e.jsxs(C.div,{variants:F,initial:"initial",animate:"animate",transition:{delay:.15},className:"space-y-3",children:[e.jsxs("h3",{className:"font-bold flex items-center gap-2",children:[e.jsx(zs,{className:"w-5 h-5"}),"Connected Services"]}),(()=>{const s=b.find(E=>E.provider==="spotify"),d=ge.isPending,N=ye.isPending;return e.jsxs("div",{className:"w-full p-4 glass rounded-2xl",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-[#1DB954]/20 flex items-center justify-center",children:e.jsx(Te,{className:"w-5 h-5 text-[#1DB954]"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("span",{className:"font-medium",children:"Spotify"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s?`Connected ${Be(new Date(s.connected_at))} ago`:"Sync your listening history"})]})]}),s?e.jsx(A,{variant:"outline",size:"sm",onClick:Je,disabled:N,className:"text-destructive hover:text-destructive",children:N?e.jsx(Q,{className:"w-4 h-4 animate-spin"}):"Disconnect"}):e.jsx(A,{size:"sm",onClick:Xe,disabled:d,className:"bg-[#1DB954] hover:bg-[#1ed760] text-white gap-2",children:d?e.jsx(Q,{className:"w-4 h-4 animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(Te,{className:"w-4 h-4"}),"Connect"]})})]}),s&&e.jsxs("div",{className:"flex items-center gap-2 mt-2 text-xs text-[#1DB954]",children:[e.jsx(ue,{className:"w-3 h-3"}),e.jsx("span",{children:"Syncing your recently played tracks"})]})]})})(),e.jsx("button",{className:"w-full p-4 glass rounded-2xl flex items-center justify-between hover:bg-muted/30 transition-colors",onClick:()=>{},children:(()=>{const s=b.find(d=>d.provider==="youtube");return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-[#FF0000]/20 flex items-center justify-center",children:e.jsx(V,{className:"w-5 h-5 text-[#FF0000]"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("span",{className:"font-medium",children:"YouTube Music"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s?`Connected ${Be(new Date(s.connected_at))} ago`:"Coming soon"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[s&&e.jsx(ue,{className:"w-4 h-4 text-[#FF0000]"}),e.jsx(ze,{className:"w-5 h-5 text-muted-foreground"})]})]})})()}),e.jsxs("div",{className:"w-full p-4 glass rounded-2xl",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-[#D51007]/20 flex items-center justify-center",children:e.jsx(Re,{className:"w-5 h-5 text-[#D51007]"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("span",{className:"font-medium",children:"Last.fm"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:Z?e.jsxs(e.Fragment,{children:["@",je," â€¢ ",P==null?void 0:P.totalScrobbles.toLocaleString()," scrobbles"]}):"Connect to see your listening history"})]})]}),Z?e.jsx(A,{variant:"outline",size:"sm",onClick:es,disabled:le.isPending,className:"text-destructive hover:text-destructive",children:le.isPending?e.jsx(Q,{className:"w-4 h-4 animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(ys,{className:"w-4 h-4 mr-1"}),"Disconnect"]})}):e.jsxs(Ue,{open:_,onOpenChange:D,children:[e.jsx(Fs,{asChild:!0,children:e.jsx(A,{size:"sm",className:"bg-[#D51007] hover:bg-[#D51007]/90",children:"Connect"})}),e.jsxs(Oe,{children:[e.jsx(He,{children:e.jsx(Ke,{children:"Connect Last.fm"})}),e.jsxs("div",{className:"space-y-4 pt-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Enter your Last.fm username to sync your listening history and scrobbles."}),e.jsx(he,{placeholder:"Your Last.fm username",value:k,onChange:s=>I(s.target.value),onKeyDown:s=>s.key==="Enter"&&we()}),e.jsxs(A,{onClick:we,disabled:W.isPending,className:"w-full bg-[#D51007] hover:bg-[#D51007]/90",children:[W.isPending?e.jsx(Q,{className:"w-4 h-4 animate-spin mr-2"}):null,W.isPending?"Connecting...":"Connect Last.fm"]})]})]})]})]}),Z&&e.jsxs("div",{className:"flex items-center gap-2 mt-2 text-xs text-[#D51007]",children:[e.jsx(ue,{className:"w-3 h-3"}),e.jsx("span",{children:"Syncing your scrobble history"})]})]}),b.length>0&&e.jsxs("div",{className:"p-4 glass rounded-2xl space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"text-sm font-medium text-muted-foreground",children:"Preferred Provider"}),e.jsx("button",{onClick:()=>u(!f),className:"text-xs text-primary hover:underline",children:"Change"})]}),f?e.jsxs("div",{className:"space-y-2",children:[e.jsx("button",{onClick:()=>_e("none"),className:`w-full p-2 rounded-lg text-left text-sm transition-colors ${!(x!=null&&x.preferred_provider)||x.preferred_provider==="none"?"bg-primary/20 text-primary":"hover:bg-muted/30"}`,children:"No preference"}),b.map(s=>e.jsxs("button",{onClick:()=>_e(s.provider),className:`w-full p-2 rounded-lg flex items-center gap-2 text-sm transition-colors ${(x==null?void 0:x.preferred_provider)===s.provider?"bg-primary/20 text-primary":"hover:bg-muted/30"}`,children:[e.jsx("div",{className:"w-6 h-6 rounded flex items-center justify-center text-xs",style:{backgroundColor:`${R[s.provider].color}20`},children:e.jsx("span",{children:R[s.provider].icon})}),R[s.provider].name]},s.id))]}):e.jsx("div",{className:"flex items-center gap-2",children:x!=null&&x.preferred_provider&&x.preferred_provider!=="none"?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-8 h-8 rounded-lg flex items-center justify-center",style:{backgroundColor:`${R[x.preferred_provider].color}20`},children:e.jsx("span",{children:R[x.preferred_provider].icon})}),e.jsx("span",{className:"text-sm font-medium",children:R[x.preferred_provider].name})]}):e.jsx("span",{className:"text-sm text-muted-foreground",children:"No preference set"})})]})]}),oe&&e.jsxs(C.div,{variants:F,initial:"initial",animate:"animate",transition:{delay:.17},className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"font-bold flex items-center gap-2",children:[e.jsx(Rs,{className:"w-5 h-5"}),"Your Music"]}),e.jsxs("select",{value:T,onChange:s=>q(s.target.value),className:"text-xs bg-muted/50 border-none rounded-lg px-2 py-1",children:[e.jsx("option",{value:"short_term",children:"Last 4 weeks"}),e.jsx("option",{value:"medium_term",children:"Last 6 months"}),e.jsx("option",{value:"long_term",children:"All time"})]})]}),e.jsxs(Ve,{defaultValue:be,value:be,className:"w-full",children:[e.jsxs(Qe,{className:"grid w-full grid-cols-3",children:[e.jsx($,{value:"tracks",disabled:!r.length,children:"Top Tracks"}),e.jsx($,{value:"artists",disabled:!h.length,children:"Top Artists"}),e.jsx($,{value:"recent",disabled:!((Fe=y==null?void 0:y.tracks)!=null&&Fe.length),children:"Recent"})]}),r.length>0&&e.jsx(M,{value:"tracks",className:"mt-4",children:e.jsx(de,{cols:{sm:1,md:2,lg:3},gap:"sm",children:r.map((s,d)=>e.jsxs("div",{className:"flex items-center gap-3 p-2 rounded-lg hover:bg-muted/30",onClick:()=>ce(s),children:[e.jsx("span",{className:"w-6 text-center text-muted-foreground text-sm",children:d+1}),e.jsx("div",{className:"w-10 h-10 rounded-lg overflow-hidden bg-muted",children:s.cover_url?e.jsx("img",{src:s.cover_url,alt:"",className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(V,{className:"w-4 h-4 text-muted-foreground"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-sm truncate",children:s.title}),e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:s.artist})]})]},s.id))})}),h.length>0&&e.jsx(M,{value:"artists",className:"mt-4",children:e.jsx(de,{cols:{sm:1,md:2,lg:3},gap:"sm",children:h.map((s,d)=>{var N,E,De;return e.jsxs("div",{className:"flex items-center gap-3 p-2 rounded-lg hover:bg-muted/30",children:[e.jsx("span",{className:"w-6 text-center text-muted-foreground text-sm",children:d+1}),e.jsx("div",{className:"w-10 h-10 rounded-full overflow-hidden bg-muted",children:(E=(N=s.images)==null?void 0:N[0])!=null&&E.url?e.jsx("img",{src:s.images[0].url,alt:"",className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(me,{className:"w-4 h-4 text-muted-foreground"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-sm truncate",children:s.name}),e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:(De=s.genres)==null?void 0:De.slice(0,2).join(", ")})]})]},s.id)})})}),(Ae=y==null?void 0:y.tracks)!=null&&Ae.length?e.jsx(M,{value:"recent",className:"mt-4",children:e.jsx(de,{cols:{sm:1,md:2,lg:3},gap:"sm",children:y.tracks.filter(s=>s.spotifyId||s.spotify_id||s.youtubeId||s.youtube_id).map(s=>e.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-lg hover:bg-muted/30 transition-colors cursor-pointer group",onClick:()=>ce(s),children:[e.jsx("div",{className:"w-12 h-12 rounded-xl overflow-hidden bg-muted",children:s.cover_url?e.jsx("img",{src:s.cover_url,alt:"",className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(V,{className:"w-5 h-5 text-muted-foreground"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-sm truncate",children:s.title}),e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:s.artist}),s.played_at&&e.jsx("p",{className:"text-[11px] text-muted-foreground/80",children:xe(s.played_at)})]}),e.jsxs("div",{className:"flex items-center gap-2 opacity-100 md:opacity-0 md:group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:d=>{d.stopPropagation(),ce(s)},className:"h-8 w-8 rounded-full bg-primary text-primary-foreground flex items-center justify-center hover:bg-primary/90","aria-label":"Play",children:e.jsx(js,{className:"w-4 h-4"})}),e.jsx(Le,{track:{spotifyId:s.spotifyId||s.spotify_id,youtubeId:s.youtubeId||s.youtube_id},canonicalTrackId:s.id,trackTitle:s.title,trackArtist:s.artist,size:"sm"})]})]},s.id))})}):e.jsx(M,{value:"recent",className:"mt-4",children:e.jsx("p",{className:"text-sm text-muted-foreground text-center py-8",children:"No recent plays. Start listening now!"})})]})]}),oe&&fe.length>0&&e.jsxs(C.div,{variants:F,initial:"initial",animate:"animate",transition:{delay:.19},className:"space-y-4",children:[e.jsxs("h3",{className:"font-bold flex items-center gap-2",children:[e.jsx(Ee,{className:"w-5 h-5 text-accent"}),"Recommended For You"]}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-5 gap-3",children:fe.slice(0,10).map(s=>e.jsxs("div",{className:"p-2 glass rounded-xl hover:bg-muted/30 transition-colors group cursor-pointer",children:[e.jsx("div",{className:"aspect-square rounded-lg overflow-hidden bg-muted mb-2",children:s.cover_url?e.jsx("img",{src:s.cover_url,alt:"",className:"w-full h-full object-cover group-hover:scale-105 transition-transform"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx($s,{className:"w-8 h-8 text-muted-foreground"})})}),e.jsx("p",{className:"font-medium text-xs truncate",children:s.title}),e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:s.artist})]},s.id))})]}),Z&&P&&e.jsxs(C.div,{variants:F,initial:"initial",animate:"animate",transition:{delay:.21},className:"space-y-4",children:[e.jsxs("h3",{className:"font-bold flex items-center gap-2",children:[e.jsx(Re,{className:"w-5 h-5 text-[#D51007]"}),"Last.fm Stats"]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{className:"p-4 glass rounded-2xl text-center",children:[e.jsx("p",{className:"text-2xl font-bold",children:P.totalScrobbles.toLocaleString()}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Total Scrobbles"})]}),e.jsxs("div",{className:"p-4 glass rounded-2xl text-center",children:[e.jsx("p",{className:"text-2xl font-bold",children:P.weeklyArtistCount}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Artists This Week"})]}),e.jsxs("div",{className:"p-4 glass rounded-2xl text-center",children:[e.jsx("p",{className:"text-2xl font-bold",children:P.topArtists.length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Top Artists"})]})]}),P.topArtists.length>0&&e.jsxs("div",{className:"p-4 glass rounded-2xl",children:[e.jsx("h4",{className:"text-sm font-medium text-muted-foreground mb-3",children:"Top Artists (3 months)"}),e.jsx("div",{className:"space-y-2",children:P.topArtists.slice(0,5).map((s,d)=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"w-5 text-muted-foreground text-sm",children:d+1}),e.jsx("div",{className:"w-8 h-8 rounded-full overflow-hidden bg-muted",children:s.imageUrl?e.jsx("img",{src:s.imageUrl,alt:"",className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(me,{className:"w-3 h-3 text-muted-foreground"})})}),e.jsx("span",{className:"flex-1 text-sm truncate",children:s.name}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[s.playcount," plays"]})]},s.name))})]}),P.recentTracks.length>0&&e.jsxs("div",{className:"p-4 glass rounded-2xl space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($e,{className:"w-5 h-5 text-[#D51007]"}),e.jsx("h4",{className:"text-sm font-medium text-muted-foreground",children:"Latest scrobbles"})]}),e.jsx("div",{className:"space-y-2",children:P.recentTracks.map((s,d)=>e.jsxs("div",{className:"flex items-center gap-3 p-2 rounded-lg hover:bg-muted/30",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg overflow-hidden bg-muted flex-shrink-0",children:s.imageUrl?e.jsx("img",{src:s.imageUrl,alt:"",className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(V,{className:"w-4 h-4 text-muted-foreground"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-sm truncate",children:s.name}),e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:s.artist}),e.jsx("p",{className:"text-[11px] text-muted-foreground/80",children:s.nowPlaying?"Now playing":s.playedAt?xe(s.playedAt):"Recently played"})]}),e.jsx(Le,{track:{spotifyId:void 0,youtubeId:void 0},canonicalTrackId:null,trackTitle:s.name,trackArtist:s.artist,size:"sm",className:"flex-shrink-0"})]},`${s.name}-${s.artist}-${d}`))})]})]}),S.length>0&&e.jsxs(C.div,{variants:F,initial:"initial",animate:"animate",transition:{delay:.2},className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"font-bold flex items-center gap-2",children:[e.jsx($e,{className:"w-5 h-5"}),"Play History"]}),n&&e.jsxs("span",{className:"text-xs text-muted-foreground",children:[n.totalPlays," total plays"]})]}),e.jsxs("div",{className:"flex gap-2 overflow-x-auto pb-2 scrollbar-hide",children:[e.jsx("button",{onClick:()=>c("all"),className:`px-3 py-1.5 rounded-full text-xs font-medium whitespace-nowrap transition-colors ${o==="all"?"bg-primary text-primary-foreground":"bg-muted/50 text-muted-foreground hover:bg-muted"}`,children:"All"}),Object.entries(R).map(([s,d])=>b.some(E=>E.provider===s)?e.jsxs("button",{onClick:()=>c(s),className:`px-3 py-1.5 rounded-full text-xs font-medium whitespace-nowrap flex items-center gap-1 transition-colors ${o===s?"text-white":"bg-muted/50 text-muted-foreground hover:bg-muted"}`,style:o===s?{backgroundColor:d.color}:{},children:[e.jsx("span",{children:d.icon}),d.name]},s):null)]}),e.jsx("div",{className:"space-y-2",children:S.map(s=>{var N;if(!s.track_id)return null;const d=s.track_id.includes("seed-")?"Sample Track":((N=s.track_id.split(":").pop())==null?void 0:N.slice(0,12))||"Unknown Track";return e.jsxs(C.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},className:"p-3 glass rounded-xl flex gap-3 hover:bg-muted/30 transition-colors cursor-pointer",onClick:()=>ws(i,s.track_id),children:[e.jsx("div",{className:"w-12 h-12 rounded-lg overflow-hidden bg-muted/50 flex-shrink-0",children:e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(V,{className:"w-6 h-6 text-muted-foreground"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-medium text-sm truncate",children:d}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(st,{provider:s.provider,size:"sm"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:xe(s.played_at)})]})]}),e.jsx(ze,{className:"w-4 h-4 text-muted-foreground flex-shrink-0"})]},s.id)})})]}),e.jsxs(C.div,{variants:F,initial:"initial",animate:"animate",transition:{delay:.25},className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{className:"p-4 glass rounded-2xl flex flex-col items-center gap-2 hover:bg-muted/30 transition-colors",children:[e.jsx(Bs,{className:"w-6 h-6 text-accent"}),e.jsx("span",{className:"text-sm font-medium",children:"Liked"}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[Ge," songs"]})]}),e.jsxs("button",{className:"p-4 glass rounded-2xl flex flex-col items-center gap-2 hover:bg-muted/30 transition-colors",children:[e.jsx(Is,{className:"w-6 h-6 text-primary"}),e.jsx("span",{className:"text-sm font-medium",children:"Saved"}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[We," songs"]})]})]}),ve&&e.jsx(C.div,{variants:F,initial:"initial",animate:"animate",transition:{delay:.3},className:"mt-6",children:e.jsxs(A,{variant:"outline",className:"w-full justify-center gap-2",onClick:()=>i("/admin"),children:[e.jsx(qe,{className:"w-4 h-4"}),"Admin Dashboard"]})})]}),e.jsx(mt,{open:U,onOpenChange:O,currentTheme:Ye,userId:(t==null?void 0:t.id)||""})]}):e.jsx(Me,{title:"Profile",children:e.jsx(Ns,{icon:me,title:"Sign in to see your profile",description:"Track your harmonic taste DNA and saved songs",actionLabel:"Sign in",onAction:()=>i("/auth")})})}export{Wt as default};
