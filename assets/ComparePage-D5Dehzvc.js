import{r as j,j as e,s as h,m as p,S as $,M as f,o as N,A as P}from"./index-BUCtqNaO.js";import{B as D}from"./BottomNav-DlBsvDfN.js";import{C as I,P as R}from"./ProfileCircle-DDDuu537.js";import{L as E}from"./TrackLineageView-CTAAFWT4.js";import{S as y,a as v,b as _,c as w,d as b}from"./select-DoWHwU3e.js";import{C as G}from"./check-Cw7034eQ.js";import{K as S,R as C}from"./rotate-ccw-Bmp3RtBO.js";import"./menu-KYx_NrMF.js";import"./search-Co_XziF7.js";import"./user-C1cDwaHe.js";import"./card-B89RdyRx.js";import"./badge-DEUcTLf6.js";import"./arrow-right-DyzBeAKN.js";import"./index-BlakwEjQ.js";function V(s,n){if(!s.progression_roman||!n.progression_roman)return 0;const t=s.progression_roman.map(i=>i.toLowerCase()),c=n.progression_roman.map(i=>i.toLowerCase()),r=t.filter(i=>c.includes(i)).length,l=new Set([...t,...c]).size,o=(i,u)=>{const g=[];for(let x=0;x<=i.length-u;x++)g.push(i.slice(x,x+u).join("-"));return g},m=o(t,2),a=o(c,2),d=m.filter(i=>a.includes(i)).length,L=Math.max(m.length,a.length)||1,z=r/l,M=d/L,A=1-Math.abs(t.length-c.length)*.1,B=s.detected_mode===n.detected_mode?.1:0,T=(z*.3+M*.5+B)*Math.max(.5,A);return Math.min(100,Math.round(T*100))}function K(s,n){if(!s.progression_roman||!n.progression_roman)return"Unable to compare - missing chord data";const t=s.progression_roman,c=n.progression_roman,r=t.filter(o=>c.map(m=>m.toLowerCase()).includes(o.toLowerCase()));if(r.length===0)return"No shared chords, different harmonic language";const l=[];return r.length===t.length&&r.length===c.length?l.push("Identical chord vocabulary"):l.push(`${r.length} shared chord(s): ${r.join(", ")}`),s.detected_mode===n.detected_mode&&s.detected_mode?l.push(`Both in ${s.detected_mode}`):s.detected_mode&&n.detected_mode&&l.push(`Different modes (${s.detected_mode} vs ${n.detected_mode})`),s.cadence_type===n.cadence_type&&s.cadence_type!=="none"&&l.push(`Same ${s.cadence_type} cadence`),l.join(". ")}function ae(){var o,m;const[s,n]=j.useState(null),[t,c]=j.useState(null),r=s&&t?V(s,t):null,l=s&&t?K(s,t):null;return e.jsxs("div",{className:"min-h-screen bg-background pb-24",children:[e.jsx("header",{className:"sticky top-0 z-40 glass-strong safe-top",children:e.jsxs("div",{className:"px-4 py-4 max-w-lg mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(I,{size:22,className:"text-primary"}),e.jsx("h1",{className:"text-xl font-bold",children:"Compare"})]}),e.jsx(R,{})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Compare the harmonic DNA of two songs"})]})}),e.jsxs("main",{className:"px-4 py-4 max-w-lg mx-auto space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Track A"}),e.jsxs(y,{value:s==null?void 0:s.id,onValueChange:a=>n(h.find(d=>d.id===a)||null),children:[e.jsx(v,{className:"bg-muted/50",children:e.jsx(_,{placeholder:"Select track"})}),e.jsx(w,{children:h.map(a=>e.jsx(b,{value:a.id,children:e.jsx("span",{className:"truncate",children:a.title})},a.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Track B"}),e.jsxs(y,{value:t==null?void 0:t.id,onValueChange:a=>c(h.find(d=>d.id===a)||null),children:[e.jsx(v,{className:"bg-muted/50",children:e.jsx(_,{placeholder:"Select track"})}),e.jsx(w,{children:h.map(a=>e.jsx(b,{value:a.id,children:e.jsx("span",{className:"truncate",children:a.title})},a.id))})]})]})]}),s&&t&&e.jsxs(p.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-6",children:[e.jsx("div",{className:"text-center py-6",children:e.jsxs("div",{className:"inline-flex items-center gap-4",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[s.cover_url&&e.jsx("img",{src:s.cover_url,alt:"",className:"w-16 h-16 rounded-xl object-cover mb-2"}),e.jsx("span",{className:"text-xs text-muted-foreground truncate max-w-20",children:s.title})]}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsxs(p.div,{initial:{scale:.5},animate:{scale:1},className:"relative",children:[e.jsx("div",{className:"w-20 h-20 rounded-full glass-strong flex items-center justify-center",children:e.jsxs("span",{className:"text-2xl font-bold gradient-text",children:[r,"%"]})}),r!==null&&r>=70&&e.jsx(p.div,{initial:{scale:0},animate:{scale:1},className:"absolute -top-1 -right-1 w-6 h-6 bg-primary rounded-full flex items-center justify-center",children:e.jsx(G,{className:"w-4 h-4 text-primary-foreground"})})]}),e.jsx("span",{className:"text-xs text-muted-foreground mt-2",children:"Similarity"})]}),e.jsxs("div",{className:"flex flex-col items-center",children:[t.cover_url&&e.jsx("img",{src:t.cover_url,alt:"",className:"w-16 h-16 rounded-xl object-cover mb-2"}),e.jsx("span",{className:"text-xs text-muted-foreground truncate max-w-20",children:t.title})]})]})}),l&&e.jsxs("div",{className:"p-4 glass rounded-xl",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2 text-primary",children:[e.jsx($,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium text-sm",children:"Analysis"})]}),e.jsx("p",{className:"text-sm text-foreground",children:l})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"font-medium text-sm",children:s.artist}),e.jsxs("div",{className:"p-3 glass rounded-xl space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsx(S,{className:"w-3 h-3"}),e.jsxs("span",{children:[s.detected_key||"?"," ",s.detected_mode||""]})]}),s.cadence_type&&s.cadence_type!=="none"&&e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsx(C,{className:"w-3 h-3"}),e.jsx("span",{className:"capitalize",children:s.cadence_type})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsx(f,{className:"w-3 h-3"}),e.jsxs("span",{children:[((o=s.progression_roman)==null?void 0:o.length)||0," chords"]})]})]}),s.progression_roman&&e.jsx("div",{className:"flex flex-wrap gap-1",children:s.progression_roman.map((a,d)=>e.jsx(N,{chord:a,size:"sm"},d))})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"font-medium text-sm",children:t.artist}),e.jsxs("div",{className:"p-3 glass rounded-xl space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsx(S,{className:"w-3 h-3"}),e.jsxs("span",{children:[t.detected_key||"?"," ",t.detected_mode||""]})]}),t.cadence_type&&t.cadence_type!=="none"&&e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsx(C,{className:"w-3 h-3"}),e.jsx("span",{className:"capitalize",children:t.cadence_type})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsx(f,{className:"w-3 h-3"}),e.jsxs("span",{children:[((m=t.progression_roman)==null?void 0:m.length)||0," chords"]})]})]}),t.progression_roman&&e.jsx("div",{className:"flex flex-wrap gap-1",children:t.progression_roman.map((a,d)=>e.jsx(N,{chord:a,size:"sm"},d))})]})]}),s.id&&t.id&&e.jsx(E,{startId:s.id,endId:t.id})]}),(!s||!t)&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-muted/50 mb-4",children:e.jsx(P,{className:"w-8 h-8 text-muted-foreground"})}),e.jsx("p",{className:"text-muted-foreground",children:"Select two tracks to compare their harmonic structure"})]})]}),e.jsx(D,{})]})}export{ae as default};
