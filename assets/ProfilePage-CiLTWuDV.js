import{c as K,a as te,k as Q,l as g,j as e,n as ss,o as R,p as he,q as pe,t as ts,r as v,D as Ue,v as Oe,w as He,x as Ve,S as as,y as rs,B as A,g as V,u as ns,i as ls,z as is,A as os,E as cs,F as ds,G as ms,b as us,H as xs,I as hs,J as ps,d as fs,K as gs,L as js,m as C,N as ys,O as vs,T as Ns,M as H,U as Te,X as bs,V as ws,P as _s,Q as Le,f as z}from"./index-BXzdp5f8.js";import{C as Cs}from"./ChordBadge-CgZV5g3f.js";import{P as Me}from"./PageLayout-BKL7_o9a.js";import{E as ks,f as F}from"./animations-CodkJlzx.js";import{u as Ss,a as Ps,b as Fs}from"./ProfileCircle-D1kp6M8q.js";import{R as As,a as oe}from"./ResponsiveLayout-BE10zfU5.js";import{I as ue}from"./input-Czo1eDmS.js";import{n as Ds}from"./navigation-PB9wrqL7.js";import{a as Ts,u as Ls,b as Ms,c as qs}from"./useLastFm-2WOtWmeZ.js";import{T as Ke,a as Qe,b as $,c as M}from"./tabs-CDXSIqHs.js";import{L as O}from"./label-u23FqATC.js";import{S as Z,a as J,b as X,c as ee,d as se}from"./select-CwFpXocN.js";import{T as Es}from"./textarea-DCO23hUK.js";import{S as zs}from"./switch-DsSRrZnp.js";import{U as ce}from"./user-jR-csLCn.js";import{S as qe}from"./shield-DxoHKKRe.js";import{Z as Rs}from"./zap-D1erfBLz.js";import{C as $s}from"./chart-column-D0l_FyrP.js";import{S as Ee}from"./sparkles-CUssqfYv.js";import{L as Bs}from"./link-CIvEi5S9.js";import{C as de}from"./check-BSXur50e.js";import{C as ze}from"./chevron-right-GAErkcBP.js";import{R as Re}from"./radio-DNzEojXD.js";import{T as Is}from"./trending-up-DEqkBRu6.js";import{D as Us}from"./disc-3-DvBuY_hj.js";import{C as $e}from"./clock-BrnN_HFo.js";import{H as Os}from"./heart-YD20Kcah.js";import{B as Hs}from"./bookmark-CEJC93lc.js";import{f as Be}from"./formatDistanceToNow-3UBXKcFR.js";import"./BottomNav-Dtgpn5bD.js";import"./menu-d4D13BJ4.js";import"./search-DIBIkkt3.js";import"./index-xg4Anv6O.js";import"./index-Baj8Cz_T.js";import"./en-US-wfBU2YNu.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vs=K("Code",[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ks=K("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=K("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qs=K("PanelsTopLeft",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M9 21V9",key:"1oto5p"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ys=K("Type",[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gs=K("WandSparkles",[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]]);function Ws(t={}){const{user:i}=te(),{limit:r=20}=t;return Q({queryKey:["play-history",i==null?void 0:i.id,r],queryFn:async()=>{if(!i)return[];const{data:l,error:c}=await g.from("user_interactions").select(`
          id,
          user_id,
          track_id,
          interaction_type,
          created_at
        `).eq("user_id",i.id).like("interaction_type","play_%").order("created_at",{ascending:!1}).limit(r);return c?(console.warn("Failed to fetch play history:",c),[]):(l||[]).map(o=>({id:o.id,user_id:o.user_id,track_id:o.track_id,provider:"spotify",action:o.interaction_type.replace("play_",""),played_at:o.created_at}))},enabled:!!i})}function Zs(){const{user:t}=te();return Q({queryKey:["play-stats",t==null?void 0:t.id],queryFn:async()=>{if(!t)return null;const{count:i}=await g.from("user_interactions").select("*",{count:"exact",head:!0}).eq("user_id",t.id).like("interaction_type","play_%");return{totalPlays:i||0,providerCounts:{},recentPlays:0}},enabled:!!t})}function Js(t){return Q({queryKey:["user-interaction-stats",t],queryFn:async()=>{if(!t)return{likes:0,saves:0,shares:0};const[i,r,l]=await Promise.all([g.from("user_interactions").select("*",{count:"exact",head:!0}).eq("user_id",t).eq("interaction_type","like"),g.from("user_interactions").select("*",{count:"exact",head:!0}).eq("user_id",t).eq("interaction_type","save"),g.from("user_interactions").select("*",{count:"exact",head:!0}).eq("user_id",t).eq("interaction_type","share")]);return{likes:i.count||0,saves:r.count||0,shares:l.count||0}},enabled:!!t})}async function Xs(t){var i;try{const[r,l]=await Promise.all([g.from("play_history").select("track_id, tracks!inner(*)").eq("user_id",t).order("played_at",{ascending:!1}).limit(200),g.from("user_interactions").select("track_id, tracks!inner(*)").eq("user_id",t).in("interaction_type",["like","save"]).order("created_at",{ascending:!1}).limit(100)]),c=(r.data||[]).map(n=>n.tracks).filter(Boolean),o=(l.data||[]).map(n=>n.tracks).filter(Boolean),p=new Map;[...c,...o].forEach(n=>{n!=null&&n.id&&p.set(n.id,n)});const u=Array.from(p.values());if(u.length===0)return null;const k=new Map;u.forEach(n=>{if(n.progression_roman&&n.progression_roman.length>0){const m=n.progression_roman.join("â†’"),S=k.get(m);S?(S.count++,S.tracks.push(n.id)):k.set(m,{count:1,tracks:[n.id]})}});const B=Array.from(k.entries()).map(([n,m])=>({progression:n.split("â†’"),count:m.count,tracks:m.tracks})).sort((n,m)=>m.count-n.count).slice(0,5),_=u.reduce((n,m)=>(m.detected_mode==="major"?n.major++:m.detected_mode==="minor"&&n.minor++,n),{major:0,minor:0}),D=_.major+_.minor,T=D>0?[{mode:"major",percentage:Math.round(_.major/D*100),count:_.major},{mode:"minor",percentage:Math.round(_.minor/D*100),count:_.minor}].sort((n,m)=>m.percentage-n.percentage):[],q=u.filter(n=>typeof n.energy=="number").map(n=>n.energy),I=q.length>0?q.reduce((n,m)=>n+m,0)/q.length:.5,U=u.reduce((n,m)=>{const S=m.cadence_type||"loop";return n[S]=(n[S]||0)+1,n},{}),x=((i=Object.entries(U).sort((n,m)=>m[1]-n[1])[0])==null?void 0:i[0])||"loop",b=u.filter(n=>typeof n.tempo=="number").map(n=>n.tempo),L=b.length>0?Math.round(b.reduce((n,m)=>n+m,0)/b.length):120;return{favoriteProgressions:B,preferredModes:T,energyPreference:I,cadencePreference:x,averageTempo:L,totalTracksAnalyzed:u.length}}catch(r){return console.error("Error computing taste DNA:",r),null}}function et(){const{user:t}=te();return Q({queryKey:["taste-dna",t==null?void 0:t.id],queryFn:async()=>t!=null&&t.id?Xs(t.id):null,enabled:!!(t!=null&&t.id),staleTime:5*60*1e3,gcTime:10*60*1e3})}function me(t){const i=new Date,r=typeof t=="string"?new Date(t):t,l=i.getTime()-r.getTime(),c=Math.floor(l/6e4),o=Math.floor(l/36e5),p=Math.floor(l/864e5);return c<1?"just now":c<60?`${c}m ago`:o<24?`${o}h ago`:p<7?`${p}d ago`:r.toLocaleDateString()}function st({provider:t,className:i,showIcon:r=!0,showName:l=!0,size:c="md"}){const o=R[t],p={sm:"px-1.5 py-0.5 text-[10px] gap-0.5",md:"px-2 py-0.5 text-xs gap-1",lg:"px-3 py-1 text-sm gap-1.5"};return e.jsxs("span",{className:ss("inline-flex items-center rounded font-medium",p[c],i),style:{backgroundColor:`${o.color}20`,color:o.color},children:[r&&e.jsx("span",{className:c==="sm"?"text-[8px]":c==="md"?"text-[10px]":"text-xs",children:o.icon}),l&&e.jsx("span",{children:o.name})]})}function tt(t){return Q({queryKey:["userTheme",t],queryFn:async()=>{var c;const i=t||((c=(await g.auth.getUser()).data.user)==null?void 0:c.id);if(!i)throw new Error("No user ID provided");const{data:r,error:l}=await g.from("user_themes").select("*").eq("user_id",i).maybeSingle();if(l)throw l;return r},staleTime:5*60*1e3,enabled:!!t||!0})}function at(){return Q({queryKey:["themePresets"],queryFn:async()=>{const{data:t,error:i}=await g.from("theme_presets").select("*").order("is_featured",{ascending:!1}).order("usage_count",{ascending:!1});if(i)throw i;return t},staleTime:10*60*1e3})}function rt(){const t=he();return pe({mutationFn:async i=>{const{data:r,error:l}=await g.from("user_themes").insert(i).select().single();if(l)throw l;return r},onSuccess:i=>{t.invalidateQueries({queryKey:["userTheme",i.user_id]})}})}function nt(){const t=he();return pe({mutationFn:async({userId:i,updates:r})=>{const{data:l,error:c}=await g.from("user_themes").update(r).eq("user_id",i).select().single();if(c)throw c;return l},onSuccess:i=>{t.invalidateQueries({queryKey:["userTheme",i.user_id]})}})}function lt(){const t=he();return pe({mutationFn:async({userId:i,presetId:r})=>{const{data:l,error:c}=await g.from("theme_presets").select("*").eq("id",r).single();if(c)throw c;await g.rpc("increment_theme_usage",{preset_id:r});const{data:o}=await g.from("user_themes").select("id").eq("user_id",i).maybeSingle();if(o){const{data:p,error:u}=await g.from("user_themes").update({theme_name:l.name,colors:l.colors,fonts:l.fonts,layout:l.layout,custom_css:l.custom_css,player_skin:l.player_skin,animated_background:l.animated_background}).eq("user_id",i).select().single();if(u)throw u;return p}else{const{data:p,error:u}=await g.from("user_themes").insert({user_id:i,theme_name:l.name,colors:l.colors,fonts:l.fonts,layout:l.layout,custom_css:l.custom_css,player_skin:l.player_skin,animated_background:l.animated_background}).select().single();if(u)throw u;return p}},onSuccess:i=>{t.invalidateQueries({queryKey:["userTheme",i.user_id]}),t.invalidateQueries({queryKey:["themePresets"]})}})}const it={background:"#000000",surface:"#1a1a1a",primary:"#3b82f6",secondary:"#8b5cf6",accent:"#f59e0b",text:"#ffffff",textMuted:"#9ca3af"},ot={heading:"Inter",body:"Inter"},Ie=["Inter","Roboto","Open Sans","Lato","Montserrat","Poppins","Playfair Display","Lora","Merriweather","Roboto Mono","Fira Code","Source Code Pro","Orbitron","Press Start 2P","Audiowide"],ct=[{value:"modern",label:"Modern"},{value:"minimal",label:"Minimal"},{value:"retro",label:"Retro"},{value:"neon",label:"Neon"},{value:"academic",label:"Academic"}],dt=[{value:"default",label:"Default"},{value:"compact",label:"Compact"},{value:"glassmorphism",label:"Glassmorphism"},{value:"retro",label:"Retro"},{value:"minimal",label:"Minimal"}];function mt({open:t,onOpenChange:i,currentTheme:r,userId:l}){const{toast:c}=ts(),[o,p]=v.useState((r==null?void 0:r.colors)||it),[u,k]=v.useState((r==null?void 0:r.fonts)||ot),[B,_]=v.useState((r==null?void 0:r.layout)||"modern"),[D,T]=v.useState((r==null?void 0:r.custom_css)||""),[q,I]=v.useState((r==null?void 0:r.player_skin)||"default"),[U,x]=v.useState((r==null?void 0:r.animated_background)||!1),{data:b}=at(),L=nt(),n=rt(),m=lt();v.useEffect(()=>{r&&(p(r.colors),k(r.fonts),_(r.layout),T(r.custom_css||""),I(r.player_skin),x(r.animated_background))},[r]);const S=async()=>{try{const a={colors:o,fonts:u,layout:B,custom_css:D||null,player_skin:q,animated_background:U};r?await L.mutateAsync({userId:l,updates:a}):await n.mutateAsync({user_id:l,...a}),c({title:"Theme saved",description:"Your profile theme has been updated successfully."}),i(!1)}catch(a){c({title:"Error saving theme",description:a instanceof Error?a.message:"Failed to save theme",variant:"destructive"})}},ae=async a=>{try{const h=await m.mutateAsync({userId:l,presetId:a});p(h.colors),k(h.fonts),_(h.layout),T(h.custom_css||""),I(h.player_skin||"default"),x(h.animated_background),c({title:"Preset applied",description:"Theme preset has been applied to the editor."})}catch(h){c({title:"Error applying preset",description:h instanceof Error?h.message:"Failed to apply preset",variant:"destructive"})}},Y=(a,h)=>{p(j=>({...j,[a]:h}))},f=(a,h)=>{k(j=>({...j,[a]:h}))};return e.jsx(Ue,{open:t,onOpenChange:i,children:e.jsxs(Oe,{className:"max-w-5xl h-[90vh]",children:[e.jsx(He,{children:e.jsxs(Ve,{className:"flex items-center gap-2",children:[e.jsx(xe,{className:"w-5 h-5"}),"Theme Editor"]})}),e.jsxs("div",{className:"flex gap-4 flex-1 overflow-hidden",children:[e.jsx("div",{className:"flex-1 overflow-y-auto",children:e.jsxs(Ke,{defaultValue:"presets",className:"w-full",children:[e.jsxs(Qe,{className:"grid w-full grid-cols-5",children:[e.jsxs($,{value:"presets",className:"flex items-center gap-1",children:[e.jsx(Gs,{className:"w-3 h-3"}),e.jsx("span",{className:"hidden sm:inline",children:"Presets"})]}),e.jsxs($,{value:"colors",className:"flex items-center gap-1",children:[e.jsx(xe,{className:"w-3 h-3"}),e.jsx("span",{className:"hidden sm:inline",children:"Colors"})]}),e.jsxs($,{value:"fonts",className:"flex items-center gap-1",children:[e.jsx(Ys,{className:"w-3 h-3"}),e.jsx("span",{className:"hidden sm:inline",children:"Fonts"})]}),e.jsxs($,{value:"layout",className:"flex items-center gap-1",children:[e.jsx(Qs,{className:"w-3 h-3"}),e.jsx("span",{className:"hidden sm:inline",children:"Layout"})]}),e.jsxs($,{value:"advanced",className:"flex items-center gap-1",children:[e.jsx(Vs,{className:"w-3 h-3"}),e.jsx("span",{className:"hidden sm:inline",children:"Advanced"})]})]}),e.jsxs(as,{className:"h-[calc(90vh-180px)] mt-4",children:[e.jsxs(M,{value:"presets",className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Start with a pre-made theme and customize it to your liking."}),e.jsx("div",{className:"grid grid-cols-1 gap-3",children:b==null?void 0:b.map(a=>e.jsxs("button",{onClick:()=>ae(a.id),className:"flex items-start gap-3 p-4 rounded-lg border hover:bg-accent transition-colors text-left",children:[e.jsx("div",{className:"w-12 h-12 rounded border shrink-0",style:{background:`linear-gradient(135deg, ${a.colors.primary}, ${a.colors.secondary})`}}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-medium",children:a.name}),e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-1",children:a.description}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[a.is_featured&&e.jsx("span",{className:"text-xs bg-primary/10 text-primary px-2 py-0.5 rounded",children:"Featured"}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[a.usage_count," uses"]})]})]})]},a.id))})]}),e.jsx(M,{value:"colors",className:"space-y-4",children:Object.entries(o).map(([a,h])=>e.jsxs("div",{className:"space-y-2",children:[e.jsx(O,{htmlFor:a,className:"capitalize",children:a.replace(/([A-Z])/g," $1").trim()}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ue,{id:a,type:"color",value:h,onChange:j=>Y(a,j.target.value),className:"w-20 h-10 p-1 cursor-pointer"}),e.jsx(ue,{type:"text",value:h,onChange:j=>Y(a,j.target.value),className:"flex-1",placeholder:"#000000"})]})]},a))}),e.jsxs(M,{value:"fonts",className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(O,{htmlFor:"heading-font",children:"Heading Font"}),e.jsxs(Z,{value:u.heading,onValueChange:a=>f("heading",a),children:[e.jsx(J,{id:"heading-font",children:e.jsx(X,{})}),e.jsx(ee,{children:Ie.map(a=>e.jsx(se,{value:a,style:{fontFamily:a},children:a},a))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(O,{htmlFor:"body-font",children:"Body Font"}),e.jsxs(Z,{value:u.body,onValueChange:a=>f("body",a),children:[e.jsx(J,{id:"body-font",children:e.jsx(X,{})}),e.jsx(ee,{children:Ie.map(a=>e.jsx(se,{value:a,style:{fontFamily:a},children:a},a))})]})]})]}),e.jsxs(M,{value:"layout",className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(O,{htmlFor:"layout-select",children:"Layout Style"}),e.jsxs(Z,{value:B,onValueChange:_,children:[e.jsx(J,{id:"layout-select",children:e.jsx(X,{})}),e.jsx(ee,{children:ct.map(a=>e.jsx(se,{value:a.value,children:a.label},a.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(O,{htmlFor:"player-skin",children:"Player Skin"}),e.jsxs(Z,{value:q,onValueChange:I,children:[e.jsx(J,{id:"player-skin",children:e.jsx(X,{})}),e.jsx(ee,{children:dt.map(a=>e.jsx(se,{value:a.value,children:a.label},a.value))})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(O,{htmlFor:"animated-bg",children:"Animated Background"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Enable subtle background animation"})]}),e.jsx(zs,{id:"animated-bg",checked:U,onCheckedChange:x})]})]}),e.jsx(M,{value:"advanced",className:"space-y-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(O,{htmlFor:"custom-css",children:"Custom CSS"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Advanced: Add custom CSS to further customize your profile"}),e.jsx(Es,{id:"custom-css",value:D,onChange:a=>T(a.target.value),placeholder:".profile-header { ... }",className:"font-mono text-sm min-h-[200px]"})]})})]})]})}),e.jsxs("div",{className:"w-80 rounded-lg border p-4 overflow-hidden",style:{backgroundColor:o.background,color:o.text,fontFamily:u.body},children:[e.jsx("h3",{className:"text-sm font-medium mb-3",style:{fontFamily:u.heading},children:"Live Preview"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"p-3 rounded",style:{backgroundColor:o.surface},children:[e.jsx("h4",{className:"font-semibold mb-1",style:{fontFamily:u.heading,color:o.primary},children:"Heading Text"}),e.jsx("p",{className:"text-sm",style:{color:o.textMuted},children:"This is how your body text will appear on your profile."})]}),e.jsx("button",{className:"w-full py-2 px-4 rounded font-medium",style:{backgroundColor:o.primary,color:o.background},children:"Primary Button"}),e.jsx("button",{className:"w-full py-2 px-4 rounded font-medium",style:{backgroundColor:o.secondary,color:o.background},children:"Secondary Button"}),e.jsx("div",{className:"p-2 rounded text-sm",style:{backgroundColor:o.accent,color:o.background},children:"Accent Color"})]})]})]}),e.jsxs(rs,{children:[e.jsx(A,{variant:"outline",onClick:()=>i(!1),children:"Cancel"}),e.jsxs(A,{onClick:S,disabled:L.isPending||n.isPending,children:[(L.isPending||n.isPending)&&e.jsx(V,{className:"w-4 h-4 mr-2 animate-spin"}),"Save Theme"]})]})]})})}const ut={energetic:"from-orange-500 to-red-500",chill:"from-blue-400 to-cyan-400",melancholic:"from-purple-500 to-indigo-600",upbeat:"from-yellow-400 to-orange-400",balanced:"from-green-400 to-emerald-500"},xt={energetic:"âš¡",chill:"ðŸŒŠ",melancholic:"ðŸŒ™",upbeat:"â˜€ï¸",balanced:"ðŸŽ¯"};function Gt(){var ke,Se,Pe,Fe,Ae;const{user:t,signOut:i,loading:r}=te(),l=ns(),[c,o]=v.useState("all"),[p,u]=v.useState(!1),[k,B]=v.useState(""),[_,D]=v.useState(!1),[T,q]=v.useState("medium_term"),[I,U]=v.useState(!1),{data:x}=Ss(),{data:b=[],refetch:L}=Ps(),{data:n}=Zs(),{data:m}=Js(t==null?void 0:t.id),{data:S=[]}=Ws({limit:20,provider:c==="all"?void 0:c}),ae=Fs(),{data:Y}=ls(),{data:f}=is(),{data:a=[]}=os(T,10),{data:h=[]}=cs(T,10),{data:j}=ds(20),{data:w}=ms(),{data:fe=[]}=us([],[],10),ge=xs(),je=hs(),{data:ye}=Ts(),{data:P}=Ls(),G=Ms(),re=qs(),{data:y,isLoading:ne}=et(),{data:Ye}=tt(t==null?void 0:t.id),{data:ve}=ps(),{openPlayer:Ne}=fs(),le=Y===!0,be=a.length>0?"tracks":h.length>0?"artists":"recent",W=!!ye,Ge=(m==null?void 0:m.likes)??0,We=(m==null?void 0:m.saves)??0,Ze=async()=>{await i(),l("/")},Je=async()=>{try{await ge.mutateAsync()}catch(s){z.error(s.message||"Failed to connect Spotify")}},Xe=async()=>{try{await je.mutateAsync(),z.success("Spotify disconnected"),L()}catch{z.error("Failed to disconnect Spotify")}},we=async()=>{if(!k.trim()){z.error("Please enter your Last.fm username");return}try{await G.mutateAsync(k.trim()),z.success("Last.fm connected successfully!"),D(!1),B(""),L()}catch(s){z.error(s.message||"Failed to connect Last.fm")}},es=async()=>{try{await re.mutateAsync(),z.success("Last.fm disconnected"),L()}catch{z.error("Failed to disconnect Last.fm")}},_e=async s=>{try{await ae.mutateAsync(s),u(!1)}catch(d){console.error("Failed to set preferred provider:",d)}},Ce=v.useCallback(s=>s.spotifyId||s.spotify_id?"spotify":s.youtubeId||s.youtube_id?"youtube":gs()??null,[]),ie=v.useCallback(s=>{const d=Ce(s);if(!d)return;const N=d==="spotify"?s.spotifyId||s.spotify_id:s.youtubeId||s.youtube_id;N&&Ne({canonicalTrackId:s.id||s.track_id||null,provider:d,providerTrackId:N,title:s.title,artist:s.artist,album:s.album,autoplay:!0,context:"profile-recent"})},[Ne,Ce]);return r?e.jsx(js,{fullScreen:!0}):t?e.jsxs(Me,{title:"Profile",headerActions:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(A,{variant:"ghost",size:"sm",onClick:()=>U(!0),children:[e.jsx(xe,{className:"w-4 h-4"}),"Theme"]}),ve&&e.jsxs(A,{variant:"ghost",size:"sm",onClick:()=>l("/admin"),children:[e.jsx(qe,{className:"w-4 h-4"}),"Admin"]}),e.jsx(A,{variant:"ghost",size:"icon",onClick:Ze,children:e.jsx(Ks,{className:"w-5 h-5"})})]}),children:[e.jsxs(As,{maxWidth:"full",className:"space-y-6",children:[e.jsxs(C.div,{variants:F,initial:"initial",animate:"animate",className:"flex items-center gap-4 p-4 glass rounded-2xl",children:[e.jsxs(ys,{className:"w-16 h-16",children:[e.jsx(vs,{src:(f==null?void 0:f.imageUrl)||(x==null?void 0:x.avatar_url)||void 0}),e.jsx(Ns,{className:"bg-gradient-to-br from-primary to-accent text-white text-xl",children:((ke=f==null?void 0:f.displayName)==null?void 0:ke[0])||((Se=t.email)==null?void 0:Se[0].toUpperCase())||"U"})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h2",{className:"font-bold truncate",children:(f==null?void 0:f.displayName)||((Pe=t.email)==null?void 0:Pe.split("@")[0])}),e.jsx("p",{className:"text-sm text-muted-foreground truncate",children:t.email}),f&&e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${f.product==="premium"?"bg-[#1DB954]/20 text-[#1DB954]":"bg-muted text-muted-foreground"}`,children:f.product==="premium"?"ðŸ‘‘ Premium":"Free"}),f.followers&&f.followers>0&&e.jsxs("span",{className:"text-xs text-muted-foreground",children:[f.followers," followers"]})]})]})]}),e.jsxs(C.div,{variants:F,initial:"initial",animate:"animate",transition:{delay:.05},className:"p-4 glass rounded-2xl",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Rs,{className:"w-5 h-5 text-primary"}),e.jsx("span",{className:"font-medium",children:"Credits"})]}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Free tier"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex-1 h-2 bg-muted rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full w-1/4 bg-gradient-to-r from-primary to-accent rounded-full"})}),e.jsx("span",{className:"text-sm font-medium",children:"25/100"})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Credits reset monthly. Used for track analysis."})]}),le&&w&&e.jsxs(C.div,{variants:F,initial:"initial",animate:"animate",transition:{delay:.1},className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($s,{className:"w-5 h-5"}),e.jsx("h3",{className:"font-bold",children:"Your Music DNA"})]}),e.jsxs("div",{className:`p-6 rounded-2xl bg-gradient-to-br ${ut[w.moodProfile]} text-white`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("span",{className:"text-4xl",children:xt[w.moodProfile]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xl font-bold capitalize",children:w.moodProfile}),e.jsx("p",{className:"text-white/80 text-sm",children:"Your listening mood profile"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white/60 text-xs",children:"Energy"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex-1 h-2 bg-white/20 rounded-full",children:e.jsx("div",{className:"h-full bg-white rounded-full",style:{width:`${w.averageEnergy*100}%`}})}),e.jsxs("span",{className:"text-sm",children:[Math.round(w.averageEnergy*100),"%"]})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white/60 text-xs",children:"Danceability"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex-1 h-2 bg-white/20 rounded-full",children:e.jsx("div",{className:"h-full bg-white rounded-full",style:{width:`${w.averageDanceability*100}%`}})}),e.jsxs("span",{className:"text-sm",children:[Math.round(w.averageDanceability*100),"%"]})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white/60 text-xs",children:"Happiness"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex-1 h-2 bg-white/20 rounded-full",children:e.jsx("div",{className:"h-full bg-white rounded-full",style:{width:`${w.averageValence*100}%`}})}),e.jsxs("span",{className:"text-sm",children:[Math.round(w.averageValence*100),"%"]})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white/60 text-xs",children:"Avg Tempo"}),e.jsxs("p",{className:"text-lg font-bold",children:[Math.round(w.averageTempo)," BPM"]})]})]})]}),w.topGenres.length>0&&e.jsxs("div",{className:"p-4 glass rounded-2xl",children:[e.jsx("h4",{className:"text-sm font-medium text-muted-foreground mb-3",children:"Top Genres"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:w.topGenres.slice(0,8).map((s,d)=>e.jsx("span",{className:"px-3 py-1 rounded-full bg-primary/10 text-primary text-sm",style:{opacity:1-d*.08},children:s.genre},s.genre))})]})]}),e.jsxs(C.div,{variants:F,initial:"initial",animate:"animate",transition:{delay:.12},className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ee,{className:"w-5 h-5 text-accent"}),e.jsx("h3",{className:"font-bold",children:"Chord Taste DNA"}),(y==null?void 0:y.totalTracksAnalyzed)&&e.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",y.totalTracksAnalyzed," tracks analyzed)"]})]}),ne&&e.jsxs("div",{className:"p-8 glass rounded-2xl text-center",children:[e.jsx(V,{className:"w-6 h-6 animate-spin mx-auto mb-2 text-muted-foreground"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Analyzing your musical taste..."})]}),!ne&&!y&&e.jsxs("div",{className:"p-8 glass rounded-2xl text-center",children:[e.jsx(H,{className:"w-8 h-8 mx-auto mb-2 text-muted-foreground"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Start listening to tracks to build your taste profile"})]}),!ne&&y&&e.jsxs(e.Fragment,{children:[y.favoriteProgressions.length>0?e.jsxs("div",{className:"p-4 glass rounded-2xl space-y-3",children:[e.jsx("h4",{className:"text-sm font-medium text-muted-foreground",children:"Favorite Progressions"}),y.favoriteProgressions.map((s,d)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex gap-1",children:s.progression.map((N,E)=>e.jsx(Cs,{chord:N,size:"sm"},E))}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[s.count," ",s.count===1?"song":"songs"]})]},d))]}):e.jsx("div",{className:"p-4 glass rounded-2xl text-center text-sm text-muted-foreground",children:"No chord progressions detected yet"}),y.preferredModes.length>0&&e.jsxs("div",{className:"p-4 glass rounded-2xl space-y-3",children:[e.jsx("h4",{className:"text-sm font-medium text-muted-foreground",children:"Mode Preference"}),e.jsx("div",{className:"flex gap-2",children:y.preferredModes.map(s=>e.jsxs("div",{className:"flex-1 p-3 rounded-xl bg-muted/50 text-center",children:[e.jsxs("span",{className:"text-lg font-bold",children:[s.percentage,"%"]}),e.jsx("p",{className:"text-xs text-muted-foreground capitalize",children:s.mode}),e.jsxs("p",{className:"text-xs text-muted-foreground/60",children:[s.count," tracks"]})]},s.mode))})]}),e.jsxs("div",{className:"p-4 glass rounded-2xl space-y-3",children:[e.jsx("h4",{className:"text-sm font-medium text-muted-foreground",children:"Energy Preference"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:"Low"}),e.jsx("div",{className:"flex-1 h-2 bg-muted rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-primary to-accent rounded-full transition-all",style:{width:`${y.energyPreference*100}%`}})}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"High"})]}),e.jsxs("p",{className:"text-xs text-muted-foreground text-center",children:[Math.round(y.energyPreference*100),"% energy â€¢ ",y.averageTempo," BPM avg"]})]}),y.cadencePreference&&e.jsxs("div",{className:"p-4 glass rounded-2xl",children:[e.jsx("h4",{className:"text-sm font-medium text-muted-foreground mb-2",children:"Cadence Style"}),e.jsx("span",{className:"inline-block px-3 py-1 rounded-full bg-primary/10 text-primary text-sm capitalize",children:y.cadencePreference})]})]})]}),e.jsxs(C.div,{variants:F,initial:"initial",animate:"animate",transition:{delay:.15},className:"space-y-3",children:[e.jsxs("h3",{className:"font-bold flex items-center gap-2",children:[e.jsx(Bs,{className:"w-5 h-5"}),"Connected Services"]}),(()=>{const s=b.find(E=>E.provider==="spotify"),d=ge.isPending,N=je.isPending;return e.jsxs("div",{className:"w-full p-4 glass rounded-2xl",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-[#1DB954]/20 flex items-center justify-center",children:e.jsx(Te,{className:"w-5 h-5 text-[#1DB954]"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("span",{className:"font-medium",children:"Spotify"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s?`Connected ${Be(new Date(s.connected_at))} ago`:"Sync your listening history"})]})]}),s?e.jsx(A,{variant:"outline",size:"sm",onClick:Xe,disabled:N,className:"text-destructive hover:text-destructive",children:N?e.jsx(V,{className:"w-4 h-4 animate-spin"}):"Disconnect"}):e.jsx(A,{size:"sm",onClick:Je,disabled:d,className:"bg-[#1DB954] hover:bg-[#1ed760] text-white gap-2",children:d?e.jsx(V,{className:"w-4 h-4 animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(Te,{className:"w-4 h-4"}),"Connect"]})})]}),s&&e.jsxs("div",{className:"flex items-center gap-2 mt-2 text-xs text-[#1DB954]",children:[e.jsx(de,{className:"w-3 h-3"}),e.jsx("span",{children:"Syncing your recently played tracks"})]})]})})(),e.jsx("button",{className:"w-full p-4 glass rounded-2xl flex items-center justify-between hover:bg-muted/30 transition-colors",onClick:()=>{},children:(()=>{const s=b.find(d=>d.provider==="youtube");return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-[#FF0000]/20 flex items-center justify-center",children:e.jsx(H,{className:"w-5 h-5 text-[#FF0000]"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("span",{className:"font-medium",children:"YouTube Music"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s?`Connected ${Be(new Date(s.connected_at))} ago`:"Coming soon"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[s&&e.jsx(de,{className:"w-4 h-4 text-[#FF0000]"}),e.jsx(ze,{className:"w-5 h-5 text-muted-foreground"})]})]})})()}),e.jsxs("div",{className:"w-full p-4 glass rounded-2xl",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-[#D51007]/20 flex items-center justify-center",children:e.jsx(Re,{className:"w-5 h-5 text-[#D51007]"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("span",{className:"font-medium",children:"Last.fm"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:W?e.jsxs(e.Fragment,{children:["@",ye," â€¢ ",P==null?void 0:P.totalScrobbles.toLocaleString()," scrobbles"]}):"Connect to see your listening history"})]})]}),W?e.jsx(A,{variant:"outline",size:"sm",onClick:es,disabled:re.isPending,className:"text-destructive hover:text-destructive",children:re.isPending?e.jsx(V,{className:"w-4 h-4 animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(bs,{className:"w-4 h-4 mr-1"}),"Disconnect"]})}):e.jsxs(Ue,{open:_,onOpenChange:D,children:[e.jsx(ws,{asChild:!0,children:e.jsx(A,{size:"sm",className:"bg-[#D51007] hover:bg-[#D51007]/90",children:"Connect"})}),e.jsxs(Oe,{children:[e.jsx(He,{children:e.jsx(Ve,{children:"Connect Last.fm"})}),e.jsxs("div",{className:"space-y-4 pt-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Enter your Last.fm username to sync your listening history and scrobbles."}),e.jsx(ue,{placeholder:"Your Last.fm username",value:k,onChange:s=>B(s.target.value),onKeyDown:s=>s.key==="Enter"&&we()}),e.jsxs(A,{onClick:we,disabled:G.isPending,className:"w-full bg-[#D51007] hover:bg-[#D51007]/90",children:[G.isPending?e.jsx(V,{className:"w-4 h-4 animate-spin mr-2"}):null,G.isPending?"Connecting...":"Connect Last.fm"]})]})]})]})]}),W&&e.jsxs("div",{className:"flex items-center gap-2 mt-2 text-xs text-[#D51007]",children:[e.jsx(de,{className:"w-3 h-3"}),e.jsx("span",{children:"Syncing your scrobble history"})]})]}),b.length>0&&e.jsxs("div",{className:"p-4 glass rounded-2xl space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"text-sm font-medium text-muted-foreground",children:"Preferred Provider"}),e.jsx("button",{onClick:()=>u(!p),className:"text-xs text-primary hover:underline",children:"Change"})]}),p?e.jsxs("div",{className:"space-y-2",children:[e.jsx("button",{onClick:()=>_e("none"),className:`w-full p-2 rounded-lg text-left text-sm transition-colors ${!(x!=null&&x.preferred_provider)||x.preferred_provider==="none"?"bg-primary/20 text-primary":"hover:bg-muted/30"}`,children:"No preference"}),b.map(s=>e.jsxs("button",{onClick:()=>_e(s.provider),className:`w-full p-2 rounded-lg flex items-center gap-2 text-sm transition-colors ${(x==null?void 0:x.preferred_provider)===s.provider?"bg-primary/20 text-primary":"hover:bg-muted/30"}`,children:[e.jsx("div",{className:"w-6 h-6 rounded flex items-center justify-center text-xs",style:{backgroundColor:`${R[s.provider].color}20`},children:e.jsx("span",{children:R[s.provider].icon})}),R[s.provider].name]},s.id))]}):e.jsx("div",{className:"flex items-center gap-2",children:x!=null&&x.preferred_provider&&x.preferred_provider!=="none"?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-8 h-8 rounded-lg flex items-center justify-center",style:{backgroundColor:`${R[x.preferred_provider].color}20`},children:e.jsx("span",{children:R[x.preferred_provider].icon})}),e.jsx("span",{className:"text-sm font-medium",children:R[x.preferred_provider].name})]}):e.jsx("span",{className:"text-sm text-muted-foreground",children:"No preference set"})})]})]}),le&&e.jsxs(C.div,{variants:F,initial:"initial",animate:"animate",transition:{delay:.17},className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"font-bold flex items-center gap-2",children:[e.jsx(Is,{className:"w-5 h-5"}),"Your Music"]}),e.jsxs("select",{value:T,onChange:s=>q(s.target.value),className:"text-xs bg-muted/50 border-none rounded-lg px-2 py-1",children:[e.jsx("option",{value:"short_term",children:"Last 4 weeks"}),e.jsx("option",{value:"medium_term",children:"Last 6 months"}),e.jsx("option",{value:"long_term",children:"All time"})]})]}),e.jsxs(Ke,{defaultValue:be,value:be,className:"w-full",children:[e.jsxs(Qe,{className:"grid w-full grid-cols-3",children:[e.jsx($,{value:"tracks",disabled:!a.length,children:"Top Tracks"}),e.jsx($,{value:"artists",disabled:!h.length,children:"Top Artists"}),e.jsx($,{value:"recent",disabled:!((Fe=j==null?void 0:j.tracks)!=null&&Fe.length),children:"Recent"})]}),a.length>0&&e.jsx(M,{value:"tracks",className:"mt-4",children:e.jsx(oe,{cols:{sm:1,md:2,lg:3},gap:"sm",children:a.map((s,d)=>e.jsxs("div",{className:"flex items-center gap-3 p-2 rounded-lg hover:bg-muted/30",onClick:()=>ie(s),children:[e.jsx("span",{className:"w-6 text-center text-muted-foreground text-sm",children:d+1}),e.jsx("div",{className:"w-10 h-10 rounded-lg overflow-hidden bg-muted",children:s.cover_url?e.jsx("img",{src:s.cover_url,alt:"",className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(H,{className:"w-4 h-4 text-muted-foreground"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-sm truncate",children:s.title}),e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:s.artist})]})]},s.id))})}),h.length>0&&e.jsx(M,{value:"artists",className:"mt-4",children:e.jsx(oe,{cols:{sm:1,md:2,lg:3},gap:"sm",children:h.map((s,d)=>{var N,E,De;return e.jsxs("div",{className:"flex items-center gap-3 p-2 rounded-lg hover:bg-muted/30",children:[e.jsx("span",{className:"w-6 text-center text-muted-foreground text-sm",children:d+1}),e.jsx("div",{className:"w-10 h-10 rounded-full overflow-hidden bg-muted",children:(E=(N=s.images)==null?void 0:N[0])!=null&&E.url?e.jsx("img",{src:s.images[0].url,alt:"",className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(ce,{className:"w-4 h-4 text-muted-foreground"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-sm truncate",children:s.name}),e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:(De=s.genres)==null?void 0:De.slice(0,2).join(", ")})]})]},s.id)})})}),(Ae=j==null?void 0:j.tracks)!=null&&Ae.length?e.jsx(M,{value:"recent",className:"mt-4",children:e.jsx(oe,{cols:{sm:1,md:2,lg:3},gap:"sm",children:j.tracks.filter(s=>s.spotifyId||s.spotify_id||s.youtubeId||s.youtube_id).map(s=>e.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-lg hover:bg-muted/30 transition-colors cursor-pointer group",onClick:()=>ie(s),children:[e.jsx("div",{className:"w-12 h-12 rounded-xl overflow-hidden bg-muted",children:s.cover_url?e.jsx("img",{src:s.cover_url,alt:"",className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(H,{className:"w-5 h-5 text-muted-foreground"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-sm truncate",children:s.title}),e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:s.artist}),s.played_at&&e.jsx("p",{className:"text-[11px] text-muted-foreground/80",children:me(s.played_at)})]}),e.jsxs("div",{className:"flex items-center gap-2 opacity-100 md:opacity-0 md:group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:d=>{d.stopPropagation(),ie(s)},className:"h-8 w-8 rounded-full bg-primary text-primary-foreground flex items-center justify-center hover:bg-primary/90","aria-label":"Play",children:e.jsx(_s,{className:"w-4 h-4"})}),e.jsx(Le,{track:{spotifyId:s.spotifyId||s.spotify_id,youtubeId:s.youtubeId||s.youtube_id},canonicalTrackId:s.id,trackTitle:s.title,trackArtist:s.artist,size:"sm"})]})]},s.id))})}):e.jsx(M,{value:"recent",className:"mt-4",children:e.jsx("p",{className:"text-sm text-muted-foreground text-center py-8",children:"No recent plays. Start listening now!"})})]})]}),le&&fe.length>0&&e.jsxs(C.div,{variants:F,initial:"initial",animate:"animate",transition:{delay:.19},className:"space-y-4",children:[e.jsxs("h3",{className:"font-bold flex items-center gap-2",children:[e.jsx(Ee,{className:"w-5 h-5 text-accent"}),"Recommended For You"]}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-5 gap-3",children:fe.slice(0,10).map(s=>e.jsxs("div",{className:"p-2 glass rounded-xl hover:bg-muted/30 transition-colors group cursor-pointer",children:[e.jsx("div",{className:"aspect-square rounded-lg overflow-hidden bg-muted mb-2",children:s.cover_url?e.jsx("img",{src:s.cover_url,alt:"",className:"w-full h-full object-cover group-hover:scale-105 transition-transform"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(Us,{className:"w-8 h-8 text-muted-foreground"})})}),e.jsx("p",{className:"font-medium text-xs truncate",children:s.title}),e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:s.artist})]},s.id))})]}),W&&P&&e.jsxs(C.div,{variants:F,initial:"initial",animate:"animate",transition:{delay:.21},className:"space-y-4",children:[e.jsxs("h3",{className:"font-bold flex items-center gap-2",children:[e.jsx(Re,{className:"w-5 h-5 text-[#D51007]"}),"Last.fm Stats"]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{className:"p-4 glass rounded-2xl text-center",children:[e.jsx("p",{className:"text-2xl font-bold",children:P.totalScrobbles.toLocaleString()}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Total Scrobbles"})]}),e.jsxs("div",{className:"p-4 glass rounded-2xl text-center",children:[e.jsx("p",{className:"text-2xl font-bold",children:P.weeklyArtistCount}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Artists This Week"})]}),e.jsxs("div",{className:"p-4 glass rounded-2xl text-center",children:[e.jsx("p",{className:"text-2xl font-bold",children:P.topArtists.length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Top Artists"})]})]}),P.topArtists.length>0&&e.jsxs("div",{className:"p-4 glass rounded-2xl",children:[e.jsx("h4",{className:"text-sm font-medium text-muted-foreground mb-3",children:"Top Artists (3 months)"}),e.jsx("div",{className:"space-y-2",children:P.topArtists.slice(0,5).map((s,d)=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"w-5 text-muted-foreground text-sm",children:d+1}),e.jsx("div",{className:"w-8 h-8 rounded-full overflow-hidden bg-muted",children:s.imageUrl?e.jsx("img",{src:s.imageUrl,alt:"",className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(ce,{className:"w-3 h-3 text-muted-foreground"})})}),e.jsx("span",{className:"flex-1 text-sm truncate",children:s.name}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[s.playcount," plays"]})]},s.name))})]}),P.recentTracks.length>0&&e.jsxs("div",{className:"p-4 glass rounded-2xl space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($e,{className:"w-5 h-5 text-[#D51007]"}),e.jsx("h4",{className:"text-sm font-medium text-muted-foreground",children:"Latest scrobbles"})]}),e.jsx("div",{className:"space-y-2",children:P.recentTracks.map((s,d)=>e.jsxs("div",{className:"flex items-center gap-3 p-2 rounded-lg hover:bg-muted/30",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg overflow-hidden bg-muted flex-shrink-0",children:s.imageUrl?e.jsx("img",{src:s.imageUrl,alt:"",className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(H,{className:"w-4 h-4 text-muted-foreground"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-sm truncate",children:s.name}),e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:s.artist}),e.jsx("p",{className:"text-[11px] text-muted-foreground/80",children:s.nowPlaying?"Now playing":s.playedAt?me(s.playedAt):"Recently played"})]}),e.jsx(Le,{track:{spotifyId:void 0,youtubeId:void 0},canonicalTrackId:null,trackTitle:s.name,trackArtist:s.artist,size:"sm",className:"flex-shrink-0"})]},`${s.name}-${s.artist}-${d}`))})]})]}),S.length>0&&e.jsxs(C.div,{variants:F,initial:"initial",animate:"animate",transition:{delay:.2},className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"font-bold flex items-center gap-2",children:[e.jsx($e,{className:"w-5 h-5"}),"Play History"]}),n&&e.jsxs("span",{className:"text-xs text-muted-foreground",children:[n.totalPlays," total plays"]})]}),e.jsxs("div",{className:"flex gap-2 overflow-x-auto pb-2 scrollbar-hide",children:[e.jsx("button",{onClick:()=>o("all"),className:`px-3 py-1.5 rounded-full text-xs font-medium whitespace-nowrap transition-colors ${c==="all"?"bg-primary text-primary-foreground":"bg-muted/50 text-muted-foreground hover:bg-muted"}`,children:"All"}),Object.entries(R).map(([s,d])=>b.some(E=>E.provider===s)?e.jsxs("button",{onClick:()=>o(s),className:`px-3 py-1.5 rounded-full text-xs font-medium whitespace-nowrap flex items-center gap-1 transition-colors ${c===s?"text-white":"bg-muted/50 text-muted-foreground hover:bg-muted"}`,style:c===s?{backgroundColor:d.color}:{},children:[e.jsx("span",{children:d.icon}),d.name]},s):null)]}),e.jsx("div",{className:"space-y-2",children:S.map(s=>{var N;if(!s.track_id)return null;const d=s.track_id.includes("seed-")?"Sample Track":((N=s.track_id.split(":").pop())==null?void 0:N.slice(0,12))||"Unknown Track";return e.jsxs(C.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},className:"p-3 glass rounded-xl flex gap-3 hover:bg-muted/30 transition-colors cursor-pointer",onClick:()=>Ds(l,s.track_id),children:[e.jsx("div",{className:"w-12 h-12 rounded-lg overflow-hidden bg-muted/50 flex-shrink-0",children:e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(H,{className:"w-6 h-6 text-muted-foreground"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-medium text-sm truncate",children:d}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(st,{provider:s.provider,size:"sm"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:me(s.played_at)})]})]}),e.jsx(ze,{className:"w-4 h-4 text-muted-foreground flex-shrink-0"})]},s.id)})})]}),e.jsxs(C.div,{variants:F,initial:"initial",animate:"animate",transition:{delay:.25},className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{className:"p-4 glass rounded-2xl flex flex-col items-center gap-2 hover:bg-muted/30 transition-colors",children:[e.jsx(Os,{className:"w-6 h-6 text-accent"}),e.jsx("span",{className:"text-sm font-medium",children:"Liked"}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[Ge," songs"]})]}),e.jsxs("button",{className:"p-4 glass rounded-2xl flex flex-col items-center gap-2 hover:bg-muted/30 transition-colors",children:[e.jsx(Hs,{className:"w-6 h-6 text-primary"}),e.jsx("span",{className:"text-sm font-medium",children:"Saved"}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[We," songs"]})]})]}),ve&&e.jsx(C.div,{variants:F,initial:"initial",animate:"animate",transition:{delay:.3},className:"mt-6",children:e.jsxs(A,{variant:"outline",className:"w-full justify-center gap-2",onClick:()=>l("/admin"),children:[e.jsx(qe,{className:"w-4 h-4"}),"Admin Dashboard"]})})]}),e.jsx(mt,{open:I,onOpenChange:U,currentTheme:Ye,userId:(t==null?void 0:t.id)||""})]}):e.jsx(Me,{title:"Profile",children:e.jsx(ks,{icon:ce,title:"Sign in to see your profile",description:"Track your harmonic taste DNA and saved songs",actionLabel:"Sign in",onAction:()=>l("/auth")})})}export{Gt as default};
